class $s{constructor(){this.listeners=[];this.unexpectedErrorHandler=function(e){setTimeout(()=>{if(e.stack){if(Qe.isErrorNoTelemetry(e)){throw new Qe(e.message+"\n\n"+e.stack)}throw new Error(e.message+"\n\n"+e.stack)}throw e},0)}}addListener(e){this.listeners.push(e);return()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e);this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const qs=new $s;function bt(s){if(!zs(s)){qs.onUnexpectedError(s)}return void 0}function Ln(s){if(s instanceof Error){const{name:e,message:t}=s;const n=s.stacktrace||s.stack;return{$isError:true,name:e,message:t,stack:n,noTelemetry:Qe.isErrorNoTelemetry(s)}}return s}const Qt="Canceled";function zs(s){if(s instanceof Ws){return true}return s instanceof Error&&s.name===Qt&&s.message===Qt}class Ws extends Error{constructor(){super(Qt);this.name=this.message}}function Vs(s){if(s){return new Error(`Illegal state: ${s}`)}else{return new Error("Illegal state")}}class Qe extends Error{constructor(e){super(e);this.name="CodeExpectedError"}static fromError(e){if(e instanceof Qe){return e}const t=new Qe;t.message=e.message;t.stack=e.stack;return t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}function Hs(s,e){const t=Object.create(null);for(const n of s){const i=e(n);let r=t[i];if(!r){r=t[i]=[]}r.push(n)}return t}function js(s,e){const t=this;let n=false;let i;return function(){if(n){return i}n=true;{i=s.apply(t,arguments)}return i}}function Gs(s,e,t=0,n=s.length){let i=t;let r=n;while(i<r){const o=Math.floor((i+r)/2);if(e(s[o])){i=o+1}else{r=o}}return i-1}class is{static{this.assertInvariants=false}constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(is.assertInvariants){if(this._prevFindLastPredicate){for(const n of this._array){if(this._prevFindLastPredicate(n)&&!e(n)){throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}}}this._prevFindLastPredicate=e}const t=Gs(this._array,e,this._findLastMonotonousLastIdx);this._findLastMonotonousLastIdx=t+1;return t===-1?void 0:this._array[t]}}var Yt;(function(s){function e(r){return r<0}s.isLessThan=e;function t(r){return r<=0}s.isLessThanOrEqual=t;function n(r){return r>0}s.isGreaterThan=n;function i(r){return r===0}s.isNeitherLessOrGreaterThan=i;s.greaterThan=1;s.lessThan=-1;s.neitherLessOrGreaterThan=0})(Yt||(Yt={}));function Ks(s,e){return(t,n)=>e(s(t),s(n))}const Qs=(s,e)=>s-e;class Lt{static{this.empty=new Lt(e=>{})}constructor(e){this.iterate=e}forEach(e){this.iterate(t=>{e(t);return true})}toArray(){const e=[];this.iterate(t=>{e.push(t);return true});return e}filter(e){return new Lt(t=>this.iterate(n=>e(n)?t(n):true))}map(e){return new Lt(t=>this.iterate(n=>t(e(n))))}some(e){let t=false;this.iterate(n=>{t=e(n);return!t});return t}findFirst(e){let t;this.iterate(n=>{if(e(n)){t=n;return false}return true});return t}findLast(e){let t;this.iterate(n=>{if(e(n)){t=n}return true});return t}findLastMaxBy(e){let t;let n=true;this.iterate(i=>{if(n||Yt.isGreaterThan(e(i,t))){n=false;t=i}return true});return t}}var wn;var yn;class Ys{constructor(e,t){this.uri=e;this.value=t}}function Js(s){return Array.isArray(s)}class We{static{this.defaultToKey=e=>e.toString()}constructor(e,t){this[wn]="ResourceMap";if(e instanceof We){this.map=new Map(e.map);this.toKey=t??We.defaultToKey}else if(Js(e)){this.map=new Map;this.toKey=t??We.defaultToKey;for(const[n,i]of e){this.set(n,i)}}else{this.map=new Map;this.toKey=e??We.defaultToKey}}set(e,t){this.map.set(this.toKey(e),new Ys(e,t));return this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){if(typeof t!=="undefined"){e=e.bind(t)}for(const[n,i]of this.map){e(i.value,i.uri,this)}}*values(){for(const e of this.map.values()){yield e.value}}*keys(){for(const e of this.map.values()){yield e.uri}}*entries(){for(const e of this.map.values()){yield[e.uri,e.value]}}*[(wn=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map){yield[e.uri,e.value]}}}class Zs{constructor(){this[yn]="LinkedMap";this._map=new Map;this._head=void 0;this._tail=void 0;this._size=0;this._state=0}clear(){this._map.clear();this._head=void 0;this._tail=void 0;this._size=0;this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){const n=this._map.get(e);if(!n){return void 0}if(t!==0){this.touch(n,t)}return n.value}set(e,t,n=0){let i=this._map.get(e);if(i){i.value=t;if(n!==0){this.touch(i,n)}}else{i={key:e,value:t,next:void 0,previous:void 0};switch(n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i);this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(!t){return void 0}this._map.delete(e);this.removeItem(t);this._size--;return t.value}shift(){if(!this._head&&!this._tail){return void 0}if(!this._head||!this._tail){throw new Error("Invalid list")}const e=this._head;this._map.delete(e.key);this.removeItem(e);this._size--;return e.value}forEach(e,t){const n=this._state;let i=this._head;while(i){if(t){e.bind(t)(i.value,i.key,this)}else{e(i.value,i.key,this)}if(this._state!==n){throw new Error(`LinkedMap got modified during iteration.`)}i=i.next}}keys(){const e=this;const t=this._state;let n=this._head;const i={[Symbol.iterator](){return i},next(){if(e._state!==t){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.key,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return i}values(){const e=this;const t=this._state;let n=this._head;const i={[Symbol.iterator](){return i},next(){if(e._state!==t){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.value,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return i}entries(){const e=this;const t=this._state;let n=this._head;const i={[Symbol.iterator](){return i},next(){if(e._state!==t){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:[n.key,n.value],done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return i}[(yn=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size){return}if(e===0){this.clear();return}let t=this._head;let n=this.size;while(t&&n>e){this._map.delete(t.key);t=t.next;n--}this._head=t;this._size=n;if(t){t.previous=void 0}this._state++}trimNew(e){if(e>=this.size){return}if(e===0){this.clear();return}let t=this._tail;let n=this.size;while(t&&n>e){this._map.delete(t.key);t=t.previous;n--}this._tail=t;this._size=n;if(t){t.next=void 0}this._state++}addItemFirst(e){if(!this._head&&!this._tail){this._tail=e}else if(!this._head){throw new Error("Invalid list")}else{e.next=this._head;this._head.previous=e}this._head=e;this._state++}addItemLast(e){if(!this._head&&!this._tail){this._head=e}else if(!this._tail){throw new Error("Invalid list")}else{e.previous=this._tail;this._tail.next=e}this._tail=e;this._state++}removeItem(e){if(e===this._head&&e===this._tail){this._head=void 0;this._tail=void 0}else if(e===this._head){if(!e.next){throw new Error("Invalid list")}e.next.previous=void 0;this._head=e.next}else if(e===this._tail){if(!e.previous){throw new Error("Invalid list")}e.previous.next=void 0;this._tail=e.previous}else{const t=e.next;const n=e.previous;if(!t||!n){throw new Error("Invalid list")}t.previous=n;n.next=t}e.next=void 0;e.previous=void 0;this._state++}touch(e,t){if(!this._head||!this._tail){throw new Error("Invalid list")}if(t!==1&&t!==2){return}if(t===1){if(e===this._head){return}const n=e.next;const i=e.previous;if(e===this._tail){i.next=void 0;this._tail=i}else{n.previous=i;i.next=n}e.previous=void 0;e.next=this._head;this._head.previous=e;this._head=e;this._state++}else if(t===2){if(e===this._tail){return}const n=e.next;const i=e.previous;if(e===this._head){n.previous=void 0;this._head=n}else{n.previous=i;i.next=n}e.next=void 0;e.previous=this._tail;this._tail.next=e;this._tail=e;this._state++}}toJSON(){const e=[];this.forEach((t,n)=>{e.push([n,t])});return e}fromJSON(e){this.clear();for(const[t,n]of e){this.set(t,n)}}}class Xs extends Zs{constructor(e,t=1){super();this._limit=e;this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e;this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1);this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){super.set(e,t,2);return this}checkTrim(){if(this.size>this._limit){this.trim(Math.round(this._limit*this._ratio))}}}class rs extends Xs{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){super.set(e,t);this.checkTrim();return this}}class ei{constructor(){this.map=new Map}add(e,t){let n=this.map.get(e);if(!n){n=new Set;this.map.set(e,n)}n.add(t)}delete(e,t){const n=this.map.get(e);if(!n){return}n.delete(t);if(n.size===0){this.map.delete(e)}}forEach(e,t){const n=this.map.get(e);if(!n){return}n.forEach(t)}get(e){const t=this.map.get(e);if(!t){return new Set}return t}}var xt;(function(s){function e(_){return _&&typeof _==="object"&&typeof _[Symbol.iterator]==="function"}s.is=e;const t=Object.freeze([]);function n(){return t}s.empty=n;function*i(_){yield _}s.single=i;function r(_){if(e(_)){return _}else{return i(_)}}s.wrap=r;function o(_){return _||t}s.from=o;function*l(_){for(let E=_.length-1;E>=0;E--){yield _[E]}}s.reverse=l;function a(_){return!_||_[Symbol.iterator]().next().done===true}s.isEmpty=a;function u(_){return _[Symbol.iterator]().next().value}s.first=u;function c(_,E){let A=0;for(const R of _){if(E(R,A++)){return true}}return false}s.some=c;function h(_,E){for(const A of _){if(E(A)){return A}}return void 0}s.find=h;function*f(_,E){for(const A of _){if(E(A)){yield A}}}s.filter=f;function*d(_,E){let A=0;for(const R of _){yield E(R,A++)}}s.map=d;function*w(_,E){let A=0;for(const R of _){yield*E(R,A++)}}s.flatMap=w;function*m(..._){for(const E of _){yield*E}}s.concat=m;function g(_,E,A){let R=A;for(const T of _){R=E(R,T)}return R}s.reduce=g;function*v(_,E,A=_.length){if(E<-_.length){E=0}if(E<0){E+=_.length}if(A<0){A+=_.length}else if(A>_.length){A=_.length}for(;E<A;E++){yield _[E]}}s.slice=v;function N(_,E=Number.POSITIVE_INFINITY){const A=[];if(E===0){return[A,_]}const R=_[Symbol.iterator]();for(let T=0;T<E;T++){const W=R.next();if(W.done){return[A,s.empty()]}A.push(W.value)}return[A,{[Symbol.iterator](){return R}}]}s.consume=N;async function x(_){const E=[];for await(const A of _){E.push(A)}return Promise.resolve(E)}s.asyncToArray=x})(xt||(xt={}));class os{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let t=this.livingDisposables.get(e);if(!t){t={parent:null,source:null,isSingleton:false,value:e,idx:os.idx++};this.livingDisposables.set(e,t)}return t}trackDisposable(e){const t=this.getDisposableData(e);if(!t.source){t.source=new Error().stack}}setParent(e,t){const n=this.getDisposableData(e);n.parent=t}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=true}getRootParent(e,t){const n=t.get(e);if(n){return n}const i=e.parent?this.getRootParent(this.getDisposableData(e.parent),t):e;t.set(e,i);return i}getTrackedDisposables(){const e=new Map;const t=[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n);return t}computeLeakingDisposables(e=10,t){let n;if(t){n=t}else{const a=new Map;const u=[...this.livingDisposables.values()].filter(h=>h.source!==null&&!this.getRootParent(h,a).isSingleton);if(u.length===0){return}const c=new Set(u.map(h=>h.value));n=u.filter(h=>{return!(h.parent&&c.has(h.parent))});if(n.length===0){throw new Error("There are cyclic diposable chains!")}}if(!n){return void 0}function i(a){function u(h,f){while(h.length>0&&f.some(d=>typeof d==="string"?d===h[0]:h[0].match(d))){h.shift()}}const c=a.source.split("\n").map(h=>h.trim().replace("at ","")).filter(h=>h!=="");u(c,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]);return c.reverse()}const r=new ei;for(const a of n){const u=i(a);for(let c=0;c<=u.length;c++){r.add(u.slice(0,c).join("\n"),a)}}n.sort(Ks(a=>a.idx,Qs));let o="";let l=0;for(const a of n.slice(0,e)){l++;const u=i(a);const c=[];for(let h=0;h<u.length;h++){let f=u[h];const d=r.get(u.slice(0,h+1).join("\n"));f=`(shared with ${d.size}/${n.length} leaks) at ${f}`;const w=r.get(u.slice(0,h).join("\n"));const m=Hs([...w].map(g=>i(g)[h]),g=>g);delete m[u[h]];for(const[g,v]of Object.entries(m)){c.unshift(`    - stacktraces of ${v.length} other leaks continue with ${g}`)}c.unshift(f)}o+=`


==================== Leaking disposable ${l}/${n.length}: ${a.value.constructor.name} ====================
${c.join("\n")}
============================================================

`}if(n.length>e){o+=`


... and ${n.length-e} more leaking disposables

`}return{leaks:n,details:o}}}function ti(s){return s}function ni(s,e){}function ls(s){if(xt.is(s)){const e=[];for(const t of s){if(t){try{t.dispose()}catch(n){e.push(n)}}}if(e.length===1){throw e[0]}else if(e.length>1){throw new AggregateError(e,"Encountered errors while disposing of store")}return Array.isArray(s)?[]:s}else if(s){s.dispose();return s}}function si(...s){const e=an(()=>ls(s));return e}function an(s){const e=ti({dispose:js(()=>{s()})});return e}class rt{static{this.DISABLE_DISPOSED_WARNING=false}constructor(){this._toDispose=new Set;this._isDisposed=false}dispose(){if(this._isDisposed){return}this._isDisposed=true;this.clear()}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size===0){return}try{ls(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e){return e}if(e===this){throw new Error("Cannot register a disposable on itself!")}if(this._isDisposed){if(!rt.DISABLE_DISPOSED_WARNING){console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack)}}else{this._toDispose.add(e)}return e}delete(e){if(!e){return}if(e===this){throw new Error("Cannot dispose a disposable on itself!")}this._toDispose.delete(e);e.dispose()}deleteAndLeak(e){if(!e){return}if(this._toDispose.has(e)){this._toDispose.delete(e)}}}class At{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new rt;ni(this._store)}dispose(){this._store.dispose()}_register(e){if(e===this){throw new Error("Cannot register a disposable on itself!")}return this._store.add(e)}}class ${static{this.Undefined=new $(void 0)}constructor(e){this.element=e;this.next=$.Undefined;this.prev=$.Undefined}}class ii{constructor(){this._first=$.Undefined;this._last=$.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===$.Undefined}clear(){let e=this._first;while(e!==$.Undefined){const t=e.next;e.prev=$.Undefined;e.next=$.Undefined;e=t}this._first=$.Undefined;this._last=$.Undefined;this._size=0}unshift(e){return this._insert(e,false)}push(e){return this._insert(e,true)}_insert(e,t){const n=new $(e);if(this._first===$.Undefined){this._first=n;this._last=n}else if(t){const r=this._last;this._last=n;n.prev=r;r.next=n}else{const r=this._first;this._first=n;n.next=r;r.prev=n}this._size+=1;let i=false;return()=>{if(!i){i=true;this._remove(n)}}}shift(){if(this._first===$.Undefined){return void 0}else{const e=this._first.element;this._remove(this._first);return e}}pop(){if(this._last===$.Undefined){return void 0}else{const e=this._last.element;this._remove(this._last);return e}}_remove(e){if(e.prev!==$.Undefined&&e.next!==$.Undefined){const t=e.prev;t.next=e.next;e.next.prev=t}else if(e.prev===$.Undefined&&e.next===$.Undefined){this._first=$.Undefined;this._last=$.Undefined}else if(e.next===$.Undefined){this._last=this._last.prev;this._last.next=$.Undefined}else if(e.prev===$.Undefined){this._first=this._first.next;this._first.prev=$.Undefined}this._size-=1}*[Symbol.iterator](){let e=this._first;while(e!==$.Undefined){yield e.element;e=e.next}}}const ri=globalThis.performance&&typeof globalThis.performance.now==="function";class un{static create(e){return new un(e)}constructor(e){this._now=ri&&e===false?Date.now:globalThis.performance.now.bind(globalThis.performance);this._startTime=this._now();this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now();this._stopTime=-1}elapsed(){if(this._stopTime!==-1){return this._stopTime-this._startTime}return this._now()-this._startTime}}var Nt;(function(s){s.None=()=>At.None;function e(b,p){return f(b,()=>void 0,0,void 0,true,void 0,p)}s.defer=e;function t(b){return(p,y=null,L)=>{let S=false;let O=void 0;O=b(F=>{if(S){return}else if(O){O.dispose()}else{S=true}return p.call(y,F)},null,L);if(S){O.dispose()}return O}}s.once=t;function n(b,p){return s.once(s.filter(b,p))}s.onceIf=n;function i(b,p,y){return c((L,S=null,O)=>b(F=>L.call(S,p(F)),null,O),y)}s.map=i;function r(b,p,y){return c((L,S=null,O)=>b(F=>{p(F);L.call(S,F)},null,O),y)}s.forEach=r;function o(b,p,y){return c((L,S=null,O)=>b(F=>p(F)&&L.call(S,F),null,O),y)}s.filter=o;function l(b){return b}s.signal=l;function a(...b){return(p,y=null,L)=>{const S=si(...b.map(O=>O(F=>p.call(y,F))));return h(S,L)}}s.any=a;function u(b,p,y,L){let S=y;return i(b,O=>{S=p(S,O);return S},L)}s.reduce=u;function c(b,p){let y;const L={onWillAddFirstListener(){y=b(S.fire,S)},onDidRemoveLastListener(){y?.dispose()}};const S=new ue(L);p?.add(S);return S.event}function h(b,p){if(p instanceof Array){p.push(b)}else if(p){p.add(b)}return b}function f(b,p,y=100,L=false,S=false,O,F){let G;let Y=void 0;let Be=void 0;let ft=0;let Ye;const Ds={leakWarningThreshold:O,onWillAddFirstListener(){G=b(Bs=>{ft++;Y=p(Y,Bs);if(L&&!Be){dt.fire(Y);Y=void 0}Ye=()=>{const Us=Y;Y=void 0;Be=void 0;if(!L||ft>1){dt.fire(Us)}ft=0};if(typeof y==="number"){clearTimeout(Be);Be=setTimeout(Ye,y)}else{if(Be===void 0){Be=0;queueMicrotask(Ye)}}})},onWillRemoveListener(){if(S&&ft>0){Ye?.()}},onDidRemoveLastListener(){Ye=void 0;G.dispose()}};const dt=new ue(Ds);F?.add(dt);return dt.event}s.debounce=f;function d(b,p=0,y){return s.debounce(b,(L,S)=>{if(!L){return[S]}L.push(S);return L},p,void 0,true,void 0,y)}s.accumulate=d;function w(b,p=(L,S)=>L===S,y){let L=true;let S;return o(b,O=>{const F=L||!p(O,S);L=false;S=O;return F},y)}s.latch=w;function m(b,p,y){return[s.filter(b,p,y),s.filter(b,L=>!p(L),y)]}s.split=m;function g(b,p=false,y=[],L){let S=y.slice();let O=b(Y=>{if(S){S.push(Y)}else{G.fire(Y)}});if(L){L.add(O)}const F=()=>{S?.forEach(Y=>G.fire(Y));S=null};const G=new ue({onWillAddFirstListener(){if(!O){O=b(Y=>G.fire(Y));if(L){L.add(O)}}},onDidAddFirstListener(){if(S){if(p){setTimeout(F)}else{F()}}},onDidRemoveLastListener(){if(O){O.dispose()}O=null}});if(L){L.add(G)}return G.event}s.buffer=g;function v(b,p){const y=(L,S,O)=>{const F=p(new x);return b(function(G){const Y=F.evaluate(G);if(Y!==N){L.call(S,Y)}},void 0,O)};return y}s.chain=v;const N=Symbol("HaltChainable");class x{constructor(){this.steps=[]}map(p){this.steps.push(p);return this}forEach(p){this.steps.push(y=>{p(y);return y});return this}filter(p){this.steps.push(y=>p(y)?y:N);return this}reduce(p,y){let L=y;this.steps.push(S=>{L=p(L,S);return L});return this}latch(p=(y,L)=>y===L){let y=true;let L;this.steps.push(S=>{const O=y||!p(S,L);y=false;L=S;return O?S:N});return this}evaluate(p){for(const y of this.steps){p=y(p);if(p===N){break}}return p}}function _(b,p,y=L=>L){const L=(...G)=>F.fire(y(...G));const S=()=>b.on(p,L);const O=()=>b.removeListener(p,L);const F=new ue({onWillAddFirstListener:S,onDidRemoveLastListener:O});return F.event}s.fromNodeEventEmitter=_;function E(b,p,y=L=>L){const L=(...G)=>F.fire(y(...G));const S=()=>b.addEventListener(p,L);const O=()=>b.removeEventListener(p,L);const F=new ue({onWillAddFirstListener:S,onDidRemoveLastListener:O});return F.event}s.fromDOMEventEmitter=E;function A(b){return new Promise(p=>t(b)(p))}s.toPromise=A;function R(b){const p=new ue;b.then(y=>{p.fire(y)},()=>{p.fire(void 0)}).finally(()=>{p.dispose()});return p.event}s.fromPromise=R;function T(b,p){return b(y=>p.fire(y))}s.forward=T;function W(b,p,y){p(y);return b(L=>p(L))}s.runAndSubscribe=W;class ne{constructor(p,y){this._observable=p;this._counter=0;this._hasChanged=false;const L={onWillAddFirstListener:()=>{p.addObserver(this);this._observable.reportChanges()},onDidRemoveLastListener:()=>{p.removeObserver(this)}};this.emitter=new ue(L);if(y){y.add(this.emitter)}}beginUpdate(p){this._counter++}handlePossibleChange(p){}handleChange(p,y){this._hasChanged=true}endUpdate(p){this._counter--;if(this._counter===0){this._observable.reportChanges();if(this._hasChanged){this._hasChanged=false;this.emitter.fire(this._observable.get())}}}}function B(b,p){const y=new ne(b,p);return y.emitter.event}s.fromObservable=B;function I(b){return(p,y,L)=>{let S=0;let O=false;const F={beginUpdate(){S++},endUpdate(){S--;if(S===0){b.reportChanges();if(O){O=false;p.call(y)}}},handlePossibleChange(){},handleChange(){O=true}};b.addObserver(F);b.reportChanges();const G={dispose(){b.removeObserver(F)}};if(L instanceof rt){L.add(G)}else if(Array.isArray(L)){L.push(G)}return G}}s.fromObservableLight=I})(Nt||(Nt={}));class It{static{this.all=new Set}static{this._idPool=0}constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${It._idPool++}`;It.all.add(this)}start(e){this._stopWatch=new un;this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e);this.elapsedOverall+=e;this.invocationCount+=1;this._stopWatch=void 0}}}let vn=-1;class hn{static{this._idPool=1}constructor(e,t,n=(hn._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=t;this.name=n;this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,t){const n=this.threshold;if(n<=0||t<n){return void 0}if(!this._stacks){this._stacks=new Map}const i=this._stacks.get(e.value)||0;this._stacks.set(e.value,i+1);this._warnCountdown-=1;if(this._warnCountdown<=0){this._warnCountdown=n*.5;const[r,o]=this.getMostFrequentStack();const l=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${o}):`;console.warn(l);console.warn(r);const a=new oi(l,r);this._errorHandler(a)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks){return void 0}let e;let t=0;for(const[n,i]of this._stacks){if(!e||t<i){e=[n,i];t=i}}return e}}class cn{static create(){const e=new Error;return new cn(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split("\n").slice(2).join("\n"))}}class oi extends Error{constructor(e,t){super(e);this.name="ListenerLeakError";this.stack=t}}class li extends Error{constructor(e,t){super(e);this.name="ListenerRefusalError";this.stack=t}}let ai=0;class Bt{constructor(e){this.value=e;this.id=ai++}}const ui=2;class ue{constructor(e){this._size=0;this._options=e;this._leakageMon=vn>0||this._options?.leakWarningThreshold?new hn(e?.onListenerError??bt,this._options?.leakWarningThreshold??vn):void 0;this._perfMon=this._options?._profName?new It(this._options._profName):void 0;this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){this._disposed=true;if(this._deliveryQueue?.current===this){this._deliveryQueue.reset()}if(this._listeners){this._listeners=void 0;this._size=0}this._options?.onDidRemoveLastListener?.();this._leakageMon?.dispose()}}get event(){this._event??=(e,t,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const l=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(l);const a=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1];const u=new li(`${l}. HINT: Stack shows most frequent listener (${a[1]}-times)`,a[0]);const c=this._options?.onListenerError||bt;c(u);return At.None}if(this._disposed){return At.None}if(t){e=e.bind(t)}const i=new Bt(e);let r;if(this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)){i.stack=cn.create();r=this._leakageMon.check(i.stack,this._size+1)}if(!this._listeners){this._options?.onWillAddFirstListener?.(this);this._listeners=i;this._options?.onDidAddFirstListener?.(this)}else if(this._listeners instanceof Bt){this._deliveryQueue??=new hi;this._listeners=[this._listeners,i]}else{this._listeners.push(i)}this._options?.onDidAddListener?.(this);this._size++;const o=an(()=>{r?.();this._removeListener(i)});if(n instanceof rt){n.add(o)}else if(Array.isArray(n)){n.push(o)}return o};return this._event}_removeListener(e){this._options?.onWillRemoveListener?.(this);if(!this._listeners){return}if(this._size===1){this._listeners=void 0;this._options?.onDidRemoveLastListener?.(this);this._size=0;return}const t=this._listeners;const n=t.indexOf(e);if(n===-1){console.log("disposed?",this._disposed);console.log("size?",this._size);console.log("arr?",JSON.stringify(this._listeners));throw new Error("Attempted to dispose unknown listener")}this._size--;t[n]=void 0;const i=this._deliveryQueue.current===this;if(this._size*ui<=t.length){let r=0;for(let o=0;o<t.length;o++){if(t[o]){t[r++]=t[o]}else if(i&&r<this._deliveryQueue.end){this._deliveryQueue.end--;if(r<this._deliveryQueue.i){this._deliveryQueue.i--}}}t.length=r}}_deliver(e,t){if(!e){return}const n=this._options?.onListenerError||bt;if(!n){e.value(t);return}try{e.value(t)}catch(i){n(i)}}_deliverQueue(e){const t=e.current._listeners;while(e.i<e.end){this._deliver(t[e.i++],e.value)}e.reset()}fire(e){if(this._deliveryQueue?.current){this._deliverQueue(this._deliveryQueue);this._perfMon?.stop()}this._perfMon?.start(this._size);if(!this._listeners);else if(this._listeners instanceof Bt){this._deliver(this._listeners,e)}else{const t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length);this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}}class hi{constructor(){this.i=-1;this.end=0}enqueue(e,t,n){this.i=0;this.end=n;this.current=e;this.value=t}reset(){this.i=this.end;this.current=void 0;this.value=void 0}}function ci(){return globalThis._VSCODE_NLS_MESSAGES}function as(){return globalThis._VSCODE_NLS_LANGUAGE}const fi=as()==="pseudo"||typeof document!=="undefined"&&document.location&&typeof document.location.hash==="string"&&document.location.hash.indexOf("pseudo=true")>=0;function En(s,e){let t;if(e.length===0);else{t=s.replace(/\{(\d+)\}/g,(n,i)=>{const r=i[0];const o=e[r];let l=n;if(typeof o==="string"){l=o}else if(typeof o==="number"||typeof o==="boolean"||o===void 0||o===null){l=String(o)}return l})}if(fi){t="［"+t.replace(/[aouei]/g,"$&$&")+"］"}return t}function ie(s,e,...t){if(typeof s==="number"){return En(di(s,e),t)}return En(e,t)}function di(s,e){const t=ci()?.[s];if(typeof t!=="string"){if(typeof e==="string"){return e}throw new Error(`!!! NLS MISSING: ${s} !!!`)}return t}const Ve="en";let Jt=false;let Zt=false;let wt=false;let us=false;let fn=false;let gt=void 0;let yt=Ve;let Sn=Ve;let gi=void 0;let me=void 0;const we=globalThis;let oe=void 0;if(typeof we.vscode!=="undefined"&&typeof we.vscode.process!=="undefined"){oe=we.vscode.process}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){oe=process}const pi=typeof oe?.versions?.electron==="string";const mi=pi&&oe?.type==="renderer";if(typeof oe==="object"){Jt=oe.platform==="win32";Zt=oe.platform==="darwin";wt=oe.platform==="linux";wt&&!!oe.env["SNAP"]&&!!oe.env["SNAP_REVISION"];!!oe.env["CI"]||!!oe.env["BUILD_ARTIFACTSTAGINGDIRECTORY"];gt=Ve;yt=Ve;const s=oe.env["VSCODE_NLS_CONFIG"];if(s){try{const e=JSON.parse(s);gt=e.userLocale;Sn=e.osLocale;yt=e.resolvedLanguage||Ve;gi=e.languagePack?.translationsConfigFile}catch(e){}}us=true}else if(typeof navigator==="object"&&!mi){me=navigator.userAgent;Jt=me.indexOf("Windows")>=0;Zt=me.indexOf("Macintosh")>=0;(me.indexOf("Macintosh")>=0||me.indexOf("iPad")>=0||me.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0;wt=me.indexOf("Linux")>=0;me?.indexOf("Mobi")>=0;fn=true;yt=as()||Ve;gt=navigator.language.toLowerCase();Sn=gt}else{console.error("Unable to resolve platform.")}const Pe=Jt;const dn=Zt;const _i=wt;const Ci=us;const gn=fn;const bi=fn&&typeof we.importScripts==="function";const Li=bi?we.origin:void 0;const de=me;const ye=yt;var xn;(function(s){function e(){return ye}s.value=e;function t(){if(ye.length===2){return ye==="en"}else if(ye.length>=3){return ye[0]==="e"&&ye[1]==="n"&&ye[2]==="-"}else{return false}}s.isDefaultVariant=t;function n(){return ye==="en"}s.isDefault=n})(xn||(xn={}));const wi=typeof we.postMessage==="function"&&!we.importScripts;(()=>{if(wi){const s=[];we.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork){for(let n=0,i=s.length;n<i;n++){const r=s[n];if(r.id===t.data.vscodeScheduleAsyncWork){s.splice(n,1);r.callback();return}}}});let e=0;return t=>{const n=++e;s.push({id:n,callback:t});we.postMessage({vscodeScheduleAsyncWork:n},"*")}}return s=>setTimeout(s)})();const hs=!!(de&&de.indexOf("Chrome")>=0);const yi=!!(de&&de.indexOf("Firefox")>=0);const vi=!!(!hs&&(de&&de.indexOf("Safari")>=0));const Ei=!!(de&&de.indexOf("Edg/")>=0);!!(de&&de.indexOf("Android")>=0);const cs=Object.freeze(function(s,e){const t=setTimeout(s.bind(e),0);return{dispose(){clearTimeout(t)}}});var An;(function(s){function e(t){if(t===s.None||t===s.Cancelled){return true}if(t instanceof Si){return true}if(!t||typeof t!=="object"){return false}return typeof t.isCancellationRequested==="boolean"&&typeof t.onCancellationRequested==="function"}s.isCancellationToken=e;s.None=Object.freeze({isCancellationRequested:false,onCancellationRequested:Nt.None});s.Cancelled=Object.freeze({isCancellationRequested:true,onCancellationRequested:cs})})(An||(An={}));class Si{constructor(){this._isCancelled=false;this._emitter=null}cancel(){if(!this._isCancelled){this._isCancelled=true;if(this._emitter){this._emitter.fire(void 0);this.dispose()}}}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){if(this._isCancelled){return cs}if(!this._emitter){this._emitter=new ue}return this._emitter.event}dispose(){if(this._emitter){this._emitter.dispose();this._emitter=null}}}function xi(s){return s}class Ai{constructor(e,t){this.lastCache=void 0;this.lastArgKey=void 0;if(typeof e==="function"){this._fn=e;this._computeKey=xi}else{this._fn=t;this._computeKey=e.getCacheKey}}get(e){const t=this._computeKey(e);if(this.lastArgKey!==t){this.lastArgKey=t;this.lastCache=this._fn(e)}return this.lastCache}}class Xt{constructor(e){this.executor=e;this._didRun=false}get hasValue(){return this._didRun}get value(){if(!this._didRun){try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=true}}if(this._error){throw this._error}return this._value}get rawValue(){return this._value}}function Ni(s){if(!s||typeof s!=="string"){return true}return s.trim().length===0}function Ii(s){return s.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function ki(s,e,t={}){if(!s){throw new Error("Cannot create regex from empty string")}if(!e){s=Ii(s)}if(t.wholeWord){if(!/\B/.test(s.charAt(0))){s="\\b"+s}if(!/\B/.test(s.charAt(s.length-1))){s=s+"\\b"}}let n="";if(t.global){n+="g"}if(!t.matchCase){n+="i"}if(t.multiline){n+="m"}if(t.unicode){n+="u"}return new RegExp(s,n)}function Oi(s){return s.split(/\r\n|\r|\n/)}function Ut(s){for(let e=0,t=s.length;e<t;e++){const n=s.charCodeAt(e);if(n!==32&&n!==9){return e}}return-1}function Ti(s,e=s.length-1){for(let t=e;t>=0;t--){const n=s.charCodeAt(t);if(n!==32&&n!==9){return t}}return-1}function Mi(s,e){if(s<e){return-1}else if(s>e){return 1}else{return 0}}function Pi(s,e,t=0,n=s.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){const a=s.charCodeAt(t);const u=e.charCodeAt(i);if(a<u){return-1}else if(a>u){return 1}}const o=n-t;const l=r-i;if(o<l){return-1}else if(o>l){return 1}return 0}function fs(s,e,t=0,n=s.length,i=0,r=e.length){for(;t<n&&i<r;t++,i++){let a=s.charCodeAt(t);let u=e.charCodeAt(i);if(a===u){continue}if(a>=128||u>=128){return Pi(s.toLowerCase(),e.toLowerCase(),t,n,i,r)}if(Nn(a)){a-=32}if(Nn(u)){u-=32}const c=a-u;if(c===0){continue}return c}const o=n-t;const l=r-i;if(o<l){return-1}else if(o>l){return 1}return 0}function Nn(s){return s>=97&&s<=122}function ds(s){return s>=65&&s<=90}function Ri(s,e){return s.length===e.length&&fs(s,e)===0}function Fi(s,e){const t=e.length;if(e.length>s.length){return false}return fs(s,e,0,t)===0}function gs(s){return 55296<=s&&s<=56319}function Di(s){return 56320<=s&&s<=57343}function Bi(s,e){return(s-55296<<10)+(e-56320)+65536}function Ui(s,e,t){const n=s.charCodeAt(t);if(gs(n)&&t+1<e){const i=s.charCodeAt(t+1);if(Di(i)){return Bi(n,i)}}return n}let $t=void 0;function $i(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function ps(s){if(!$t){$t=$i()}return $t.test(s)}const qi=/^[\t\n\r\x20-\x7E]*$/;function zi(s){return qi.test(s)}const Wi=/[\u2028\u2029]/;function ms(s){return Wi.test(s)}const Vi=String.fromCharCode(65279);function Hi(s){return!!(s&&s.length>0&&s.charCodeAt(0)===65279)}class Je{static{this.ambiguousCharacterData=new Xt(()=>{return JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')})}static{this.cache=new Ai({getCacheKey:JSON.stringify},e=>{function t(c){const h=new Map;for(let f=0;f<c.length;f+=2){h.set(c[f],c[f+1])}return h}function n(c,h){const f=new Map(c);for(const[d,w]of h){f.set(d,w)}return f}function i(c,h){if(!c){return h}const f=new Map;for(const[d,w]of c){if(h.has(d)){f.set(d,w)}}return f}const r=this.ambiguousCharacterData.value;let o=e.filter(c=>!c.startsWith("_")&&c in r);if(o.length===0){o=["_default"]}let l=void 0;for(const c of o){const h=t(r[c]);l=i(l,h)}const a=t(r["_common"]);const u=n(a,l);return new Je(u)})}static getInstance(e){return Je.cache.get(Array.from(e))}static{this._locales=new Xt(()=>Object.keys(Je.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return Je._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let t=0;t<e.length;t++){const n=e.codePointAt(t);if(typeof n==="number"&&this.isAmbiguous(n)){return true}}return false}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}class Ze{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){if(!this._data){this._data=new Set(Ze.getRawData())}return this._data}static isInvisibleCharacter(e){return Ze.getData().has(e)}static containsInvisibleCharacter(e){for(let t=0;t<e.length;t++){const n=e.codePointAt(t);if(typeof n==="number"&&Ze.isInvisibleCharacter(n)){return true}}return false}static get codePoints(){return Ze.getData()}}const qt="default";const ji="$initialize";class Gi{constructor(e,t,n,i,r){this.vsWorker=e;this.req=t;this.channel=n;this.method=i;this.args=r;this.type=0}}class In{constructor(e,t,n,i){this.vsWorker=e;this.seq=t;this.res=n;this.err=i;this.type=1}}class Ki{constructor(e,t,n,i,r){this.vsWorker=e;this.req=t;this.channel=n;this.eventName=i;this.arg=r;this.type=2}}class Qi{constructor(e,t,n){this.vsWorker=e;this.req=t;this.event=n;this.type=3}}class Yi{constructor(e,t){this.vsWorker=e;this.req=t;this.type=4}}class Ji{constructor(e){this._workerId=-1;this._handler=e;this._lastSentReq=0;this._pendingReplies=Object.create(null);this._pendingEmitters=new Map;this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t,n){const i=String(++this._lastSentReq);return new Promise((r,o)=>{this._pendingReplies[i]={resolve:r,reject:o};this._send(new Gi(this._workerId,i,e,t,n))})}listen(e,t,n){let i=null;const r=new ue({onWillAddFirstListener:()=>{i=String(++this._lastSentReq);this._pendingEmitters.set(i,r);this._send(new Ki(this._workerId,i,e,t,n))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(i);this._send(new Yi(this._workerId,i));i=null}});return r.event}handleMessage(e){if(!e||!e.vsWorker){return}if(this._workerId!==-1&&e.vsWorker!==this._workerId){return}this._handleMessage(e)}createProxyToRemoteChannel(e,t){const n={get:(i,r)=>{if(typeof r==="string"&&!i[r]){if(Cs(r)){i[r]=o=>{return this.listen(e,r,o)}}else if(_s(r)){i[r]=this.listen(e,r,void 0)}else if(r.charCodeAt(0)===36){i[r]=async(...o)=>{await t?.();return this.sendMessage(e,r,o)}}}return i[r]}};return new Proxy(Object.create(null),n)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];delete this._pendingReplies[e.seq];if(e.err){let n=e.err;if(e.err.$isError){n=new Error;n.name=e.err.name;n.message=e.err.message;n.stack=e.err.stack}t.reject(n);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;const n=this._handler.handleMessage(e.channel,e.method,e.args);n.then(i=>{this._send(new In(this._workerId,t,i,void 0))},i=>{if(i.detail instanceof Error){i.detail=Ln(i.detail)}this._send(new In(this._workerId,t,void 0,Ln(i)))})}_handleSubscribeEventMessage(e){const t=e.req;const n=this._handler.handleEvent(e.channel,e.eventName,e.arg)(i=>{this._send(new Qi(this._workerId,t,i))});this._pendingEvents.set(t,n)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose();this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0){for(let n=0;n<e.args.length;n++){if(e.args[n]instanceof ArrayBuffer){t.push(e.args[n])}}}else if(e.type===1){if(e.res instanceof ArrayBuffer){t.push(e.res)}}this._handler.sendMessage(e,t)}}function _s(s){return s[0]==="o"&&s[1]==="n"&&ds(s.charCodeAt(2))}function Cs(s){return/^onDynamic/.test(s)&&ds(s.charCodeAt(9))}class Zi{constructor(e,t){this._localChannels=new Map;this._remoteChannels=new Map;this._requestHandlerFactory=t;this._requestHandler=null;this._protocol=new Ji({sendMessage:(n,i)=>{e(n,i)},handleMessage:(n,i,r)=>this._handleMessage(n,i,r),handleEvent:(n,i,r)=>this._handleEvent(n,i,r)})}onmessage(e){this._protocol.handleMessage(e)}_handleMessage(e,t,n){if(e===qt&&t===ji){return this.initialize(n[0],n[1],n[2])}const i=e===qt?this._requestHandler:this._localChannels.get(e);if(!i){return Promise.reject(new Error(`Missing channel ${e} on worker thread`))}if(typeof i[t]!=="function"){return Promise.reject(new Error(`Missing method ${t} on worker thread channel ${e}`))}try{return Promise.resolve(i[t].apply(i,n))}catch(r){return Promise.reject(r)}}_handleEvent(e,t,n){const i=e===qt?this._requestHandler:this._localChannels.get(e);if(!i){throw new Error(`Missing channel ${e} on worker thread`)}if(Cs(t)){const r=i[t].call(i,n);if(typeof r!=="function"){throw new Error(`Missing dynamic event ${t} on request handler.`)}return r}if(_s(t)){const r=i[t];if(typeof r!=="function"){throw new Error(`Missing event ${t} on request handler.`)}return r}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}getChannel(e){if(!this._remoteChannels.has(e)){const t=this._protocol.createProxyToRemoteChannel(e);this._remoteChannels.set(e,t)}return this._remoteChannels.get(e)}async initialize(e,t,n){this._protocol.setWorkerId(e);if(this._requestHandlerFactory){this._requestHandler=this._requestHandlerFactory(this);return}if(t){if(typeof t.baseUrl!=="undefined"){delete t["baseUrl"]}if(typeof t.paths!=="undefined"){if(typeof t.paths.vs!=="undefined"){delete t.paths["vs"]}}if(typeof t.trustedTypesPolicy!=="undefined"){delete t["trustedTypesPolicy"]}t.catchError=true;globalThis.require.config(t)}return Promise.reject(new Error(`Unexpected usage`))}}let en=false;function Xi(s){if(en){return}en=true;const e=new Zi(t=>globalThis.postMessage(t),t=>s(t));globalThis.onmessage=t=>{e.onmessage(t.data)}}function er(s){globalThis.onmessage=e=>{if(!en){Xi(s)}}}class xe{constructor(e,t,n,i){this.originalStart=e;this.originalLength=t;this.modifiedStart=n;this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}const pt=typeof Buffer!=="undefined";const tr=new Xt(()=>new Uint8Array(256));let zt;let Wt;class te{static alloc(e){if(pt){return new te(Buffer.allocUnsafe(e))}else{return new te(new Uint8Array(e))}}static wrap(e){if(pt&&!Buffer.isBuffer(e)){e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return new te(e)}static fromString(e,t){const n=t?.dontUseNodeBuffer||false;if(!n&&pt){return new te(Buffer.from(e))}else{if(!zt){zt=new TextEncoder}return new te(zt.encode(e))}}static fromByteArray(e){const t=te.alloc(e.length);for(let n=0,i=e.length;n<i;n++){t.buffer[n]=e[n]}return t}static concat(e,t){if(typeof t==="undefined"){t=0;for(let r=0,o=e.length;r<o;r++){t+=e[r].byteLength}}const n=te.alloc(t);let i=0;for(let r=0,o=e.length;r<o;r++){const l=e[r];n.set(l,i);i+=l.byteLength}return n}constructor(e){this.buffer=e;this.byteLength=this.buffer.byteLength}clone(){const e=te.alloc(this.byteLength);e.set(this);return e}toString(){if(pt){return this.buffer.toString()}else{if(!Wt){Wt=new TextDecoder}return Wt.decode(this.buffer)}}slice(e,t){return new te(this.buffer.subarray(e,t))}set(e,t){if(e instanceof te){this.buffer.set(e.buffer,t)}else if(e instanceof Uint8Array){this.buffer.set(e,t)}else if(e instanceof ArrayBuffer){this.buffer.set(new Uint8Array(e),t)}else if(ArrayBuffer.isView(e)){this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t)}else{throw new Error(`Unknown argument 'array'`)}}readUInt32BE(e){return vt(this.buffer,e)}writeUInt32BE(e,t){Et(this.buffer,e,t)}readUInt32LE(e){return rr(this.buffer,e)}writeUInt32LE(e,t){or(this.buffer,e,t)}readUInt8(e){return lr(this.buffer,e)}writeUInt8(e,t){ar(this.buffer,e,t)}indexOf(e,t=0){return nr(this.buffer,e instanceof te?e.buffer:e,t)}}function nr(s,e,t=0){const n=e.byteLength;const i=s.byteLength;if(n===0){return 0}if(n===1){return s.indexOf(e[0])}if(n>i-t){return-1}const r=tr.value;r.fill(e.length);for(let u=0;u<e.length;u++){r[e[u]]=e.length-u-1}let o=t+e.length-1;let l=o;let a=-1;while(o<i){if(s[o]===e[l]){if(l===0){a=o;break}o--;l--}else{o+=Math.max(e.length-l,r[s[o]]);l=e.length-1}}return a}function sr(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0}function ir(s,e,t){s[t+0]=e&255;e=e>>>8;s[t+1]=e&255}function vt(s,e){return s[e]*2**24+s[e+1]*2**16+s[e+2]*2**8+s[e+3]}function Et(s,e,t){s[t+3]=e;e=e>>>8;s[t+2]=e;e=e>>>8;s[t+1]=e;e=e>>>8;s[t]=e}function rr(s,e){return s[e+0]<<0>>>0|s[e+1]<<8>>>0|s[e+2]<<16>>>0|s[e+3]<<24>>>0}function or(s,e,t){s[t+0]=e&255;e=e>>>8;s[t+1]=e&255;e=e>>>8;s[t+2]=e&255;e=e>>>8;s[t+3]=e&255}function lr(s,e){return s[e]}function ar(s,e,t){s[t]=e}function bs(s){let e=0;let t=0;let n=0;const i=new Uint8Array(Math.floor(s.length/4*3));const r=l=>{switch(t){case 3:i[n++]=e|l;t=0;break;case 2:i[n++]=e|l>>>2;e=l<<6;t=3;break;case 1:i[n++]=e|l>>>4;e=l<<4;t=2;break;default:e=l<<2;t=1}};for(let l=0;l<s.length;l++){const a=s.charCodeAt(l);if(a>=65&&a<=90){r(a-65)}else if(a>=97&&a<=122){r(a-97+26)}else if(a>=48&&a<=57){r(a-48+52)}else if(a===43||a===45){r(62)}else if(a===47||a===95){r(63)}else if(a===61){break}else{throw new SyntaxError(`Unexpected base64 character ${s[l]}`)}}const o=n;while(t>0){r(0)}return te.wrap(i).slice(0,o)}const ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function Ls({buffer:s},e=true,t=false){const n=t?hr:ur;let i="";const r=s.byteLength%3;let o=0;for(;o<s.byteLength-r;o+=3){const l=s[o+0];const a=s[o+1];const u=s[o+2];i+=n[l>>>2];i+=n[(l<<4|a>>>4)&63];i+=n[(a<<2|u>>>6)&63];i+=n[u&63]}if(r===1){const l=s[o+0];i+=n[l>>>2];i+=n[l<<4&63];if(e){i+="=="}}else if(r===2){const l=s[o+0];const a=s[o+1];i+=n[l>>>2];i+=n[(l<<4|a>>>4)&63];i+=n[a<<2&63];if(e){i+="="}}return i}function Ae(s,e){switch(typeof s){case"object":if(s===null){return ce(349,e)}else if(Array.isArray(s)){return fr(s,e)}return dr(s,e);case"string":return pn(s,e);case"boolean":return cr(s,e);case"number":return ce(s,e);case"undefined":return ce(937,e);default:return ce(617,e)}}function ce(s,e){return(e<<5)-e+s|0}function cr(s,e){return ce(s?433:863,e)}function pn(s,e){e=ce(149417,e);for(let t=0,n=s.length;t<n;t++){e=ce(s.charCodeAt(t),e)}return e}function fr(s,e){e=ce(104579,e);return s.reduce((t,n)=>Ae(n,t),e)}function dr(s,e){e=ce(181387,e);return Object.keys(s).sort().reduce((t,n)=>{t=pn(n,t);return Ae(s[n],t)},e)}class Ue{static Assert(e,t){if(!e){throw new Error(t)}}}class $e{static Copy(e,t,n,i,r){for(let o=0;o<r;o++){n[i+o]=e[t+o]}}static Copy2(e,t,n,i,r){for(let o=0;o<r;o++){n[i+o]=e[t+o]}}}class kn{constructor(){this.m_changes=[];this.m_originalStart=1073741824;this.m_modifiedStart=1073741824;this.m_originalCount=0;this.m_modifiedCount=0}MarkNextChange(){if(this.m_originalCount>0||this.m_modifiedCount>0){this.m_changes.push(new xe(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount))}this.m_originalCount=0;this.m_modifiedCount=0;this.m_originalStart=1073741824;this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e);this.m_modifiedStart=Math.min(this.m_modifiedStart,t);this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e);this.m_modifiedStart=Math.min(this.m_modifiedStart,t);this.m_modifiedCount++}getChanges(){if(this.m_originalCount>0||this.m_modifiedCount>0){this.MarkNextChange()}return this.m_changes}getReverseChanges(){if(this.m_originalCount>0||this.m_modifiedCount>0){this.MarkNextChange()}this.m_changes.reverse();return this.m_changes}}class Oe{constructor(e,t,n=null){this.ContinueProcessingPredicate=n;this._originalSequence=e;this._modifiedSequence=t;const[i,r,o]=Oe._getElements(e);const[l,a,u]=Oe._getElements(t);this._hasStrings=o&&u;this._originalStringElements=i;this._originalElementsOrHash=r;this._modifiedStringElements=l;this._modifiedElementsOrHash=a;this.m_forwardHistory=[];this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]==="string"}static _getElements(e){const t=e.getElements();if(Oe._isStringArray(t)){const n=new Int32Array(t.length);for(let i=0,r=t.length;i<r;i++){n[i]=pn(t[i],0)}return[t,n,true]}if(t instanceof Int32Array){return[[],t,false]}return[[],new Int32Array(t),false]}ElementsAreEqual(e,t){if(this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]){return false}return this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:true}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t)){return false}const n=Oe._getStrictElement(this._originalSequence,e);const i=Oe._getStrictElement(this._modifiedSequence,t);return n===i}static _getStrictElement(e,t){if(typeof e.getStrictElement==="function"){return e.getStrictElement(t)}return null}OriginalElementsAreEqual(e,t){if(this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]){return false}return this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:true}ModifiedElementsAreEqual(e,t){if(this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]){return false}return this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:true}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,n,i,r){const o=[false];let l=this.ComputeDiffRecursive(e,t,n,i,o);if(r){l=this.PrettifyChanges(l)}return{quitEarly:o[0],changes:l}}ComputeDiffRecursive(e,t,n,i,r){r[0]=false;while(e<=t&&n<=i&&this.ElementsAreEqual(e,n)){e++;n++}while(t>=e&&i>=n&&this.ElementsAreEqual(t,i)){t--;i--}if(e>t||n>i){let h;if(n<=i){Ue.Assert(e===t+1,"originalStart should only be one more than originalEnd");h=[new xe(e,0,n,i-n+1)]}else if(e<=t){Ue.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd");h=[new xe(e,t-e+1,n,0)]}else{Ue.Assert(e===t+1,"originalStart should only be one more than originalEnd");Ue.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd");h=[]}return h}const o=[0];const l=[0];const a=this.ComputeRecursionPoint(e,t,n,i,o,l,r);const u=o[0];const c=l[0];if(a!==null){return a}else if(!r[0]){const h=this.ComputeDiffRecursive(e,u,n,c,r);let f=[];if(!r[0]){f=this.ComputeDiffRecursive(u+1,t,c+1,i,r)}else{f=[new xe(u+1,t-(u+1)+1,c+1,i-(c+1)+1)]}return this.ConcatenateChanges(h,f)}return[new xe(e,t-e+1,n,i-n+1)]}WALKTRACE(e,t,n,i,r,o,l,a,u,c,h,f,d,w,m,g,v,N){let x=null;let _=null;let E=new kn;let A=t;let R=n;let T=d[0]-g[0]-i;let W=-1073741824;let ne=this.m_forwardHistory.length-1;do{const B=T+e;if(B===A||B<R&&u[B-1]<u[B+1]){h=u[B+1];w=h-T-i;if(h<W){E.MarkNextChange()}W=h;E.AddModifiedElement(h+1,w);T=B+1-e}else{h=u[B-1]+1;w=h-T-i;if(h<W){E.MarkNextChange()}W=h-1;E.AddOriginalElement(h,w+1);T=B-1-e}if(ne>=0){u=this.m_forwardHistory[ne];e=u[0];A=1;R=u.length-1}}while(--ne>=-1);x=E.getReverseChanges();if(N[0]){let B=d[0]+1;let I=g[0]+1;if(x!==null&&x.length>0){const b=x[x.length-1];B=Math.max(B,b.getOriginalEnd());I=Math.max(I,b.getModifiedEnd())}_=[new xe(B,f-B+1,I,m-I+1)]}else{E=new kn;A=o;R=l;T=d[0]-g[0]-a;W=1073741824;ne=v?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const B=T+r;if(B===A||B<R&&c[B-1]>=c[B+1]){h=c[B+1]-1;w=h-T-a;if(h>W){E.MarkNextChange()}W=h+1;E.AddOriginalElement(h+1,w+1);T=B+1-r}else{h=c[B-1];w=h-T-a;if(h>W){E.MarkNextChange()}W=h;E.AddModifiedElement(h+1,w+1);T=B-1-r}if(ne>=0){c=this.m_reverseHistory[ne];r=c[0];A=1;R=c.length-1}}while(--ne>=-1);_=E.getChanges()}return this.ConcatenateChanges(x,_)}ComputeRecursionPoint(e,t,n,i,r,o,l){let a=0,u=0;let c=0,h=0;let f=0,d=0;e--;n--;r[0]=0;o[0]=0;this.m_forwardHistory=[];this.m_reverseHistory=[];const w=t-e+(i-n);const m=w+1;const g=new Int32Array(m);const v=new Int32Array(m);const N=i-n;const x=t-e;const _=e-n;const E=t-i;const A=x-N;const R=A%2===0;g[N]=e;v[x]=t;l[0]=false;for(let T=1;T<=w/2+1;T++){let W=0;let ne=0;c=this.ClipDiagonalBound(N-T,T,N,m);h=this.ClipDiagonalBound(N+T,T,N,m);for(let I=c;I<=h;I+=2){if(I===c||I<h&&g[I-1]<g[I+1]){a=g[I+1]}else{a=g[I-1]+1}u=a-(I-N)-_;const b=a;while(a<t&&u<i&&this.ElementsAreEqual(a+1,u+1)){a++;u++}g[I]=a;if(a+u>W+ne){W=a;ne=u}if(!R&&Math.abs(I-x)<=T-1){if(a>=v[I]){r[0]=a;o[0]=u;if(b<=v[I]&&1447>0&&T<=1447+1){return this.WALKTRACE(N,c,h,_,x,f,d,E,g,v,a,t,r,u,i,o,R,l)}else{return null}}}}const B=(W-e+(ne-n)-T)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(W,B)){l[0]=true;r[0]=W;o[0]=ne;if(B>0&&1447>0&&T<=1447+1){return this.WALKTRACE(N,c,h,_,x,f,d,E,g,v,a,t,r,u,i,o,R,l)}else{e++;n++;return[new xe(e,t-e+1,n,i-n+1)]}}f=this.ClipDiagonalBound(x-T,T,x,m);d=this.ClipDiagonalBound(x+T,T,x,m);for(let I=f;I<=d;I+=2){if(I===f||I<d&&v[I-1]>=v[I+1]){a=v[I+1]-1}else{a=v[I-1]}u=a-(I-x)-E;const b=a;while(a>e&&u>n&&this.ElementsAreEqual(a,u)){a--;u--}v[I]=a;if(R&&Math.abs(I-N)<=T){if(a<=g[I]){r[0]=a;o[0]=u;if(b>=g[I]&&1447>0&&T<=1447+1){return this.WALKTRACE(N,c,h,_,x,f,d,E,g,v,a,t,r,u,i,o,R,l)}else{return null}}}}if(T<=1447){let I=new Int32Array(h-c+2);I[0]=N-c+1;$e.Copy2(g,c,I,1,h-c+1);this.m_forwardHistory.push(I);I=new Int32Array(d-f+2);I[0]=x-f+1;$e.Copy2(v,f,I,1,d-f+1);this.m_reverseHistory.push(I)}}return this.WALKTRACE(N,c,h,_,x,f,d,E,g,v,a,t,r,u,i,o,R,l)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const n=e[t];const i=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length;const r=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length;const o=n.originalLength>0;const l=n.modifiedLength>0;while(n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<r&&(!o||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!l||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength))){const u=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);const c=this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength);if(c&&!u){break}n.originalStart++;n.modifiedStart++}const a=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],a)){e[t]=a[0];e.splice(t+1,1);t--;continue}}for(let t=e.length-1;t>=0;t--){const n=e[t];let i=0;let r=0;if(t>0){const h=e[t-1];i=h.originalStart+h.originalLength;r=h.modifiedStart+h.modifiedLength}const o=n.originalLength>0;const l=n.modifiedLength>0;let a=0;let u=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let h=1;;h++){const f=n.originalStart-h;const d=n.modifiedStart-h;if(f<i||d<r){break}if(o&&!this.OriginalElementsAreEqual(f,f+n.originalLength)){break}if(l&&!this.ModifiedElementsAreEqual(d,d+n.modifiedLength)){break}const w=f===i&&d===r;const m=(w?5:0)+this._boundaryScore(f,n.originalLength,d,n.modifiedLength);if(m>u){u=m;a=h}}n.originalStart-=a;n.modifiedStart-=a;const c=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],c)){e[t-1]=c[0];e.splice(t,1);t++;continue}}if(this._hasStrings){for(let t=1,n=e.length;t<n;t++){const i=e[t-1];const r=e[t];const o=r.originalStart-i.originalStart-i.originalLength;const l=i.originalStart;const a=r.originalStart+r.originalLength;const u=a-l;const c=i.modifiedStart;const h=r.modifiedStart+r.modifiedLength;const f=h-c;if(o<5&&u<20&&f<20){const d=this._findBetterContiguousSequence(l,u,c,f,o);if(d){const[w,m]=d;if(w!==i.originalStart+i.originalLength||m!==i.modifiedStart+i.modifiedLength){i.originalLength=w-i.originalStart;i.modifiedLength=m-i.modifiedStart;r.originalStart=w+o;r.modifiedStart=m+o;r.originalLength=a-r.originalStart;r.modifiedLength=h-r.modifiedStart}}}}}return e}_findBetterContiguousSequence(e,t,n,i,r){if(t<r||i<r){return null}const o=e+t-r+1;const l=n+i-r+1;let a=0;let u=0;let c=0;for(let h=e;h<o;h++){for(let f=n;f<l;f++){const d=this._contiguousSequenceScore(h,f,r);if(d>0&&d>a){a=d;u=h;c=f}}}if(a>0){return[u,c]}return null}_contiguousSequenceScore(e,t,n){let i=0;for(let r=0;r<n;r++){if(!this.ElementsAreEqual(e+r,t+r)){return 0}i+=this._originalStringElements[e+r].length}return i}_OriginalIsBoundary(e){if(e<=0||e>=this._originalElementsOrHash.length-1){return true}return this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1)){return true}if(t>0){const n=e+t;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n)){return true}}return false}_ModifiedIsBoundary(e){if(e<=0||e>=this._modifiedElementsOrHash.length-1){return true}return this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1)){return true}if(t>0){const n=e+t;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n)){return true}}return false}_boundaryScore(e,t,n,i){const r=this._OriginalRegionIsBoundary(e,t)?1:0;const o=this._ModifiedRegionIsBoundary(n,i)?1:0;return r+o}ConcatenateChanges(e,t){const n=[];if(e.length===0||t.length===0){return t.length>0?t:e}else if(this.ChangesOverlap(e[e.length-1],t[0],n)){const i=new Array(e.length+t.length-1);$e.Copy(e,0,i,0,e.length-1);i[e.length-1]=n[0];$e.Copy(t,1,i,e.length,t.length-1);return i}else{const i=new Array(e.length+t.length);$e.Copy(e,0,i,0,e.length);$e.Copy(t,0,i,e.length,t.length);return i}}ChangesOverlap(e,t,n){Ue.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change");Ue.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change");if(e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const i=e.originalStart;let r=e.originalLength;const o=e.modifiedStart;let l=e.modifiedLength;if(e.originalStart+e.originalLength>=t.originalStart){r=t.originalStart+t.originalLength-e.originalStart}if(e.modifiedStart+e.modifiedLength>=t.modifiedStart){l=t.modifiedStart+t.modifiedLength-e.modifiedStart}n[0]=new xe(i,r,o,l);return true}else{n[0]=null;return false}}ClipDiagonalBound(e,t,n,i){if(e>=0&&e<i){return e}const r=n;const o=i-n-1;const l=t%2===0;if(e<0){const a=r%2===0;return l===a?0:1}else{const a=o%2===0;return l===a?i-1:i-2}}}var On={};let Me;const Vt=globalThis.vscode;if(typeof Vt!=="undefined"&&typeof Vt.process!=="undefined"){const s=Vt.process;Me={get platform(){return s.platform},get arch(){return s.arch},get env(){return s.env},cwd(){return s.cwd()}}}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){Me={get platform(){return process.platform},get arch(){return process.arch},get env(){return On},cwd(){return On["VSCODE_CWD"]||process.cwd()}}}else{Me={get platform(){return Pe?"win32":dn?"darwin":"linux"},get arch(){return void 0},get env(){return{}},cwd(){return"/"}}}const kt=Me.cwd;const gr=Me.env;const pr=Me.platform;Me.arch;const mr=65;const _r=97;const Cr=90;const br=122;const ke=46;const K=47;const se=92;const ve=58;const Lr=63;class ws extends Error{constructor(e,t,n){let i;if(typeof t==="string"&&t.indexOf("not ")===0){i="must not be";t=t.replace(/^not /,"")}else{i="must be"}const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${i} of type ${t}`;o+=`. Received type ${typeof n}`;super(o);this.code="ERR_INVALID_ARG_TYPE"}}function wr(s,e){if(s===null||typeof s!=="object"){throw new ws(e,"Object",s)}}function z(s,e){if(typeof s!=="string"){throw new ws(e,"string",s)}}const le=pr==="win32";function k(s){return s===K||s===se}function tn(s){return s===K}function Ee(s){return s>=mr&&s<=Cr||s>=_r&&s<=br}function Ot(s,e,t,n){let i="";let r=0;let o=-1;let l=0;let a=0;for(let u=0;u<=s.length;++u){if(u<s.length){a=s.charCodeAt(u)}else if(n(a)){break}else{a=K}if(n(a)){if(o===u-1||l===1);else if(l===2){if(i.length<2||r!==2||i.charCodeAt(i.length-1)!==ke||i.charCodeAt(i.length-2)!==ke){if(i.length>2){const c=i.lastIndexOf(t);if(c===-1){i="";r=0}else{i=i.slice(0,c);r=i.length-1-i.lastIndexOf(t)}o=u;l=0;continue}else if(i.length!==0){i="";r=0;o=u;l=0;continue}}if(e){i+=i.length>0?`${t}..`:"..";r=2}}else{if(i.length>0){i+=`${t}${s.slice(o+1,u)}`}else{i=s.slice(o+1,u)}r=u-o-1}o=u;l=0}else if(a===ke&&l!==-1){++l}else{l=-1}}return i}function yr(s){return s?`${s[0]==="."?"":"."}${s}`:""}function ys(s,e){wr(e,"pathObject");const t=e.dir||e.root;const n=e.base||`${e.name||""}${yr(e.ext)}`;if(!t){return n}return t===e.root?`${t}${n}`:`${t}${s}${n}`}const H={resolve(...s){let e="";let t="";let n=false;for(let i=s.length-1;i>=-1;i--){let r;if(i>=0){r=s[i];z(r,`paths[${i}]`);if(r.length===0){continue}}else if(e.length===0){r=kt()}else{r=gr[`=${e}`]||kt();if(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===se){r=`${e}\\`}}const o=r.length;let l=0;let a="";let u=false;const c=r.charCodeAt(0);if(o===1){if(k(c)){l=1;u=true}}else if(k(c)){u=true;if(k(r.charCodeAt(1))){let h=2;let f=h;while(h<o&&!k(r.charCodeAt(h))){h++}if(h<o&&h!==f){const d=r.slice(f,h);f=h;while(h<o&&k(r.charCodeAt(h))){h++}if(h<o&&h!==f){f=h;while(h<o&&!k(r.charCodeAt(h))){h++}if(h===o||h!==f){a=`\\\\${d}\\${r.slice(f,h)}`;l=h}}}}else{l=1}}else if(Ee(c)&&r.charCodeAt(1)===ve){a=r.slice(0,2);l=2;if(o>2&&k(r.charCodeAt(2))){u=true;l=3}}if(a.length>0){if(e.length>0){if(a.toLowerCase()!==e.toLowerCase()){continue}}else{e=a}}if(n){if(e.length>0){break}}else{t=`${r.slice(l)}\\${t}`;n=u;if(u&&e.length>0){break}}}t=Ot(t,!n,"\\",k);return n?`${e}\\${t}`:`${e}${t}`||"."},normalize(s){z(s,"path");const e=s.length;if(e===0){return"."}let t=0;let n;let i=false;const r=s.charCodeAt(0);if(e===1){return tn(r)?"\\":s}if(k(r)){i=true;if(k(s.charCodeAt(1))){let l=2;let a=l;while(l<e&&!k(s.charCodeAt(l))){l++}if(l<e&&l!==a){const u=s.slice(a,l);a=l;while(l<e&&k(s.charCodeAt(l))){l++}if(l<e&&l!==a){a=l;while(l<e&&!k(s.charCodeAt(l))){l++}if(l===e){return`\\\\${u}\\${s.slice(a)}\\`}if(l!==a){n=`\\\\${u}\\${s.slice(a,l)}`;t=l}}}}else{t=1}}else if(Ee(r)&&s.charCodeAt(1)===ve){n=s.slice(0,2);t=2;if(e>2&&k(s.charCodeAt(2))){i=true;t=3}}let o=t<e?Ot(s.slice(t),!i,"\\",k):"";if(o.length===0&&!i){o="."}if(o.length>0&&k(s.charCodeAt(e-1))){o+="\\"}if(n===void 0){return i?`\\${o}`:o}return i?`${n}\\${o}`:`${n}${o}`},isAbsolute(s){z(s,"path");const e=s.length;if(e===0){return false}const t=s.charCodeAt(0);return k(t)||e>2&&Ee(t)&&s.charCodeAt(1)===ve&&k(s.charCodeAt(2))},join(...s){if(s.length===0){return"."}let e;let t;for(let r=0;r<s.length;++r){const o=s[r];z(o,"path");if(o.length>0){if(e===void 0){e=t=o}else{e+=`\\${o}`}}}if(e===void 0){return"."}let n=true;let i=0;if(typeof t==="string"&&k(t.charCodeAt(0))){++i;const r=t.length;if(r>1&&k(t.charCodeAt(1))){++i;if(r>2){if(k(t.charCodeAt(2))){++i}else{n=false}}}}if(n){while(i<e.length&&k(e.charCodeAt(i))){i++}if(i>=2){e=`\\${e.slice(i)}`}}return H.normalize(e)},relative(s,e){z(s,"from");z(e,"to");if(s===e){return""}const t=H.resolve(s);const n=H.resolve(e);if(t===n){return""}s=t.toLowerCase();e=n.toLowerCase();if(s===e){return""}let i=0;while(i<s.length&&s.charCodeAt(i)===se){i++}let r=s.length;while(r-1>i&&s.charCodeAt(r-1)===se){r--}const o=r-i;let l=0;while(l<e.length&&e.charCodeAt(l)===se){l++}let a=e.length;while(a-1>l&&e.charCodeAt(a-1)===se){a--}const u=a-l;const c=o<u?o:u;let h=-1;let f=0;for(;f<c;f++){const w=s.charCodeAt(i+f);if(w!==e.charCodeAt(l+f)){break}else if(w===se){h=f}}if(f!==c){if(h===-1){return n}}else{if(u>c){if(e.charCodeAt(l+f)===se){return n.slice(l+f+1)}if(f===2){return n.slice(l+f)}}if(o>c){if(s.charCodeAt(i+f)===se){h=f}else if(f===2){h=3}}if(h===-1){h=0}}let d="";for(f=i+h+1;f<=r;++f){if(f===r||s.charCodeAt(f)===se){d+=d.length===0?"..":"\\.."}}l+=h;if(d.length>0){return`${d}${n.slice(l,a)}`}if(n.charCodeAt(l)===se){++l}return n.slice(l,a)},toNamespacedPath(s){if(typeof s!=="string"||s.length===0){return s}const e=H.resolve(s);if(e.length<=2){return s}if(e.charCodeAt(0)===se){if(e.charCodeAt(1)===se){const t=e.charCodeAt(2);if(t!==Lr&&t!==ke){return`\\\\?\\UNC\\${e.slice(2)}`}}}else if(Ee(e.charCodeAt(0))&&e.charCodeAt(1)===ve&&e.charCodeAt(2)===se){return`\\\\?\\${e}`}return s},dirname(s){z(s,"path");const e=s.length;if(e===0){return"."}let t=-1;let n=0;const i=s.charCodeAt(0);if(e===1){return k(i)?s:"."}if(k(i)){t=n=1;if(k(s.charCodeAt(1))){let l=2;let a=l;while(l<e&&!k(s.charCodeAt(l))){l++}if(l<e&&l!==a){a=l;while(l<e&&k(s.charCodeAt(l))){l++}if(l<e&&l!==a){a=l;while(l<e&&!k(s.charCodeAt(l))){l++}if(l===e){return s}if(l!==a){t=n=l+1}}}}}else if(Ee(i)&&s.charCodeAt(1)===ve){t=e>2&&k(s.charCodeAt(2))?3:2;n=t}let r=-1;let o=true;for(let l=e-1;l>=n;--l){if(k(s.charCodeAt(l))){if(!o){r=l;break}}else{o=false}}if(r===-1){if(t===-1){return"."}r=t}return s.slice(0,r)},basename(s,e){if(e!==void 0){z(e,"suffix")}z(s,"path");let t=0;let n=-1;let i=true;let r;if(s.length>=2&&Ee(s.charCodeAt(0))&&s.charCodeAt(1)===ve){t=2}if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s){return""}let o=e.length-1;let l=-1;for(r=s.length-1;r>=t;--r){const a=s.charCodeAt(r);if(k(a)){if(!i){t=r+1;break}}else{if(l===-1){i=false;l=r+1}if(o>=0){if(a===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=l}}}}if(t===n){n=l}else if(n===-1){n=s.length}return s.slice(t,n)}for(r=s.length-1;r>=t;--r){if(k(s.charCodeAt(r))){if(!i){t=r+1;break}}else if(n===-1){i=false;n=r+1}}if(n===-1){return""}return s.slice(t,n)},extname(s){z(s,"path");let e=0;let t=-1;let n=0;let i=-1;let r=true;let o=0;if(s.length>=2&&s.charCodeAt(1)===ve&&Ee(s.charCodeAt(0))){e=n=2}for(let l=s.length-1;l>=e;--l){const a=s.charCodeAt(l);if(k(a)){if(!r){n=l+1;break}continue}if(i===-1){r=false;i=l+1}if(a===ke){if(t===-1){t=l}else if(o!==1){o=1}}else if(t!==-1){o=-1}}if(t===-1||i===-1||o===0||o===1&&t===i-1&&t===n+1){return""}return s.slice(t,i)},format:ys.bind(null,"\\"),parse(s){z(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0){return e}const t=s.length;let n=0;let i=s.charCodeAt(0);if(t===1){if(k(i)){e.root=e.dir=s;return e}e.base=e.name=s;return e}if(k(i)){n=1;if(k(s.charCodeAt(1))){let h=2;let f=h;while(h<t&&!k(s.charCodeAt(h))){h++}if(h<t&&h!==f){f=h;while(h<t&&k(s.charCodeAt(h))){h++}if(h<t&&h!==f){f=h;while(h<t&&!k(s.charCodeAt(h))){h++}if(h===t){n=h}else if(h!==f){n=h+1}}}}}else if(Ee(i)&&s.charCodeAt(1)===ve){if(t<=2){e.root=e.dir=s;return e}n=2;if(k(s.charCodeAt(2))){if(t===3){e.root=e.dir=s;return e}n=3}}if(n>0){e.root=s.slice(0,n)}let r=-1;let o=n;let l=-1;let a=true;let u=s.length-1;let c=0;for(;u>=n;--u){i=s.charCodeAt(u);if(k(i)){if(!a){o=u+1;break}continue}if(l===-1){a=false;l=u+1}if(i===ke){if(r===-1){r=u}else if(c!==1){c=1}}else if(r!==-1){c=-1}}if(l!==-1){if(r===-1||c===0||c===1&&r===l-1&&r===o+1){e.base=e.name=s.slice(o,l)}else{e.name=s.slice(o,r);e.base=s.slice(o,l);e.ext=s.slice(r,l)}}if(o>0&&o!==n){e.dir=s.slice(0,o-1)}else{e.dir=e.root}return e},sep:"\\",delimiter:";",win32:null,posix:null};const vr=(()=>{if(le){const s=/\\/g;return()=>{const e=kt().replace(s,"/");return e.slice(e.indexOf("/"))}}return()=>kt()})();const D={resolve(...s){let e="";let t=false;for(let n=s.length-1;n>=-1&&!t;n--){const i=n>=0?s[n]:vr();z(i,`paths[${n}]`);if(i.length===0){continue}e=`${i}/${e}`;t=i.charCodeAt(0)===K}e=Ot(e,!t,"/",tn);if(t){return`/${e}`}return e.length>0?e:"."},normalize(s){z(s,"path");if(s.length===0){return"."}const e=s.charCodeAt(0)===K;const t=s.charCodeAt(s.length-1)===K;s=Ot(s,!e,"/",tn);if(s.length===0){if(e){return"/"}return t?"./":"."}if(t){s+="/"}return e?`/${s}`:s},isAbsolute(s){z(s,"path");return s.length>0&&s.charCodeAt(0)===K},join(...s){if(s.length===0){return"."}let e;for(let t=0;t<s.length;++t){const n=s[t];z(n,"path");if(n.length>0){if(e===void 0){e=n}else{e+=`/${n}`}}}if(e===void 0){return"."}return D.normalize(e)},relative(s,e){z(s,"from");z(e,"to");if(s===e){return""}s=D.resolve(s);e=D.resolve(e);if(s===e){return""}const t=1;const n=s.length;const i=n-t;const r=1;const o=e.length-r;const l=i<o?i:o;let a=-1;let u=0;for(;u<l;u++){const h=s.charCodeAt(t+u);if(h!==e.charCodeAt(r+u)){break}else if(h===K){a=u}}if(u===l){if(o>l){if(e.charCodeAt(r+u)===K){return e.slice(r+u+1)}if(u===0){return e.slice(r+u)}}else if(i>l){if(s.charCodeAt(t+u)===K){a=u}else if(u===0){a=0}}}let c="";for(u=t+a+1;u<=n;++u){if(u===n||s.charCodeAt(u)===K){c+=c.length===0?"..":"/.."}}return`${c}${e.slice(r+a)}`},toNamespacedPath(s){return s},dirname(s){z(s,"path");if(s.length===0){return"."}const e=s.charCodeAt(0)===K;let t=-1;let n=true;for(let i=s.length-1;i>=1;--i){if(s.charCodeAt(i)===K){if(!n){t=i;break}}else{n=false}}if(t===-1){return e?"/":"."}if(e&&t===1){return"//"}return s.slice(0,t)},basename(s,e){if(e!==void 0){z(e,"ext")}z(s,"path");let t=0;let n=-1;let i=true;let r;if(e!==void 0&&e.length>0&&e.length<=s.length){if(e===s){return""}let o=e.length-1;let l=-1;for(r=s.length-1;r>=0;--r){const a=s.charCodeAt(r);if(a===K){if(!i){t=r+1;break}}else{if(l===-1){i=false;l=r+1}if(o>=0){if(a===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=l}}}}if(t===n){n=l}else if(n===-1){n=s.length}return s.slice(t,n)}for(r=s.length-1;r>=0;--r){if(s.charCodeAt(r)===K){if(!i){t=r+1;break}}else if(n===-1){i=false;n=r+1}}if(n===-1){return""}return s.slice(t,n)},extname(s){z(s,"path");let e=-1;let t=0;let n=-1;let i=true;let r=0;for(let o=s.length-1;o>=0;--o){const l=s.charCodeAt(o);if(l===K){if(!i){t=o+1;break}continue}if(n===-1){i=false;n=o+1}if(l===ke){if(e===-1){e=o}else if(r!==1){r=1}}else if(e!==-1){r=-1}}if(e===-1||n===-1||r===0||r===1&&e===n-1&&e===t+1){return""}return s.slice(e,n)},format:ys.bind(null,"/"),parse(s){z(s,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0){return e}const t=s.charCodeAt(0)===K;let n;if(t){e.root="/";n=1}else{n=0}let i=-1;let r=0;let o=-1;let l=true;let a=s.length-1;let u=0;for(;a>=n;--a){const c=s.charCodeAt(a);if(c===K){if(!l){r=a+1;break}continue}if(o===-1){l=false;o=a+1}if(c===ke){if(i===-1){i=a}else if(u!==1){u=1}}else if(i!==-1){u=-1}}if(o!==-1){const c=r===0&&t?1:r;if(i===-1||u===0||u===1&&i===o-1&&i===r+1){e.base=e.name=s.slice(c,o)}else{e.name=s.slice(c,i);e.base=s.slice(c,o);e.ext=s.slice(i,o)}}if(r>0){e.dir=s.slice(0,r-1)}else if(t){e.dir="/"}return e},sep:"/",delimiter:":",win32:null,posix:null};D.win32=H.win32=H;D.posix=H.posix=D;const Er=le?H.normalize:D.normalize;le?H.isAbsolute:D.isAbsolute;const Sr=le?H.join:D.join;const xr=le?H.resolve:D.resolve;const Ar=le?H.relative:D.relative;const Nr=le?H.dirname:D.dirname;le?H.basename:D.basename;le?H.extname:D.extname;le?H.parse:D.parse;const St=le?H.sep:D.sep;le?H.delimiter:D.delimiter;const Ir=/^\w[\w\d+.-]*$/;const kr=/^\//;const Or=/^\/\//;function Tr(s,e){if(!s.scheme&&e){throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${s.authority}", path: "${s.path}", query: "${s.query}", fragment: "${s.fragment}"}`)}if(s.scheme&&!Ir.test(s.scheme)){throw new Error("[UriError]: Scheme contains illegal characters.")}if(s.path){if(s.authority){if(!kr.test(s.path)){throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}}else{if(Or.test(s.path)){throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}}}function Mr(s,e){if(!s&&!e){return"file"}return s}function Pr(s,e){switch(s){case"https":case"http":case"file":if(!e){e=he}else if(e[0]!==he){e=he+e}break}return e}const U="";const he="/";const Rr=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class V{static isUri(e){if(e instanceof V){return true}if(!e){return false}return typeof e.authority==="string"&&typeof e.fragment==="string"&&typeof e.path==="string"&&typeof e.query==="string"&&typeof e.scheme==="string"&&typeof e.fsPath==="string"&&typeof e.with==="function"&&typeof e.toString==="function"}constructor(e,t,n,i,r,o=false){if(typeof e==="object"){this.scheme=e.scheme||U;this.authority=e.authority||U;this.path=e.path||U;this.query=e.query||U;this.fragment=e.fragment||U}else{this.scheme=Mr(e,o);this.authority=t||U;this.path=Pr(this.scheme,n||U);this.query=i||U;this.fragment=r||U;Tr(this,o)}}get fsPath(){return Tt(this,false)}with(e){if(!e){return this}let{scheme:t,authority:n,path:i,query:r,fragment:o}=e;if(t===void 0){t=this.scheme}else if(t===null){t=U}if(n===void 0){n=this.authority}else if(n===null){n=U}if(i===void 0){i=this.path}else if(i===null){i=U}if(r===void 0){r=this.query}else if(r===null){r=U}if(o===void 0){o=this.fragment}else if(o===null){o=U}if(t===this.scheme&&n===this.authority&&i===this.path&&r===this.query&&o===this.fragment){return this}return new qe(t,n,i,r,o)}static parse(e,t=false){const n=Rr.exec(e);if(!n){return new qe(U,U,U,U,U)}return new qe(n[2]||U,mt(n[4]||U),mt(n[5]||U),mt(n[7]||U),mt(n[9]||U),t)}static file(e){let t=U;if(Pe){e=e.replace(/\\/g,he)}if(e[0]===he&&e[1]===he){const n=e.indexOf(he,2);if(n===-1){t=e.substring(2);e=he}else{t=e.substring(2,n);e=e.substring(n)||he}}return new qe("file",t,e,U,U)}static from(e,t){const n=new qe(e.scheme,e.authority,e.path,e.query,e.fragment,t);return n}static joinPath(e,...t){if(!e.path){throw new Error(`[UriError]: cannot call joinPath on URI without path`)}let n;if(Pe&&e.scheme==="file"){n=V.file(H.join(Tt(e,true),...t)).path}else{n=D.join(e.path,...t)}return e.with({path:n})}toString(e=false){return nn(this,e)}toJSON(){return this}static revive(e){if(!e){return e}else if(e instanceof V){return e}else{const t=new qe(e);t._formatted=e.external??null;t._fsPath=e._sep===vs?e.fsPath??null:null;return t}}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}}const vs=Pe?1:void 0;class qe extends V{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){if(!this._fsPath){this._fsPath=Tt(this,false)}return this._fsPath}toString(e=false){if(!e){if(!this._formatted){this._formatted=nn(this,false)}return this._formatted}else{return nn(this,true)}}toJSON(){const e={$mid:1};if(this._fsPath){e.fsPath=this._fsPath;e._sep=vs}if(this._formatted){e.external=this._formatted}if(this.path){e.path=this.path}if(this.scheme){e.scheme=this.scheme}if(this.authority){e.authority=this.authority}if(this.query){e.query=this.query}if(this.fragment){e.fragment=this.fragment}return e}}const Es={[58]:"%3A",[47]:"%2F",[63]:"%3F",[35]:"%23",[91]:"%5B",[93]:"%5D",[64]:"%40",[33]:"%21",[36]:"%24",[38]:"%26",[39]:"%27",[40]:"%28",[41]:"%29",[42]:"%2A",[43]:"%2B",[44]:"%2C",[59]:"%3B",[61]:"%3D",[32]:"%20"};function Tn(s,e,t){let n=void 0;let i=-1;for(let r=0;r<s.length;r++){const o=s.charCodeAt(r);if(o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||o===45||o===46||o===95||o===126||e&&o===47||t&&o===91||t&&o===93||t&&o===58){if(i!==-1){n+=encodeURIComponent(s.substring(i,r));i=-1}if(n!==void 0){n+=s.charAt(r)}}else{if(n===void 0){n=s.substr(0,r)}const l=Es[o];if(l!==void 0){if(i!==-1){n+=encodeURIComponent(s.substring(i,r));i=-1}n+=l}else if(i===-1){i=r}}}if(i!==-1){n+=encodeURIComponent(s.substring(i))}return n!==void 0?n:s}function Fr(s){let e=void 0;for(let t=0;t<s.length;t++){const n=s.charCodeAt(t);if(n===35||n===63){if(e===void 0){e=s.substr(0,t)}e+=Es[n]}else{if(e!==void 0){e+=s[t]}}}return e!==void 0?e:s}function Tt(s,e){let t;if(s.authority&&s.path.length>1&&s.scheme==="file"){t=`//${s.authority}${s.path}`}else if(s.path.charCodeAt(0)===47&&(s.path.charCodeAt(1)>=65&&s.path.charCodeAt(1)<=90||s.path.charCodeAt(1)>=97&&s.path.charCodeAt(1)<=122)&&s.path.charCodeAt(2)===58){if(!e){t=s.path[1].toLowerCase()+s.path.substr(2)}else{t=s.path.substr(1)}}else{t=s.path}if(Pe){t=t.replace(/\//g,"\\")}return t}function nn(s,e){const t=!e?Tn:Fr;let n="";let{scheme:i,authority:r,path:o,query:l,fragment:a}=s;if(i){n+=i;n+=":"}if(r||i==="file"){n+=he;n+=he}if(r){let u=r.indexOf("@");if(u!==-1){const c=r.substr(0,u);r=r.substr(u+1);u=c.lastIndexOf(":");if(u===-1){n+=t(c,false,false)}else{n+=t(c.substr(0,u),false,false);n+=":";n+=t(c.substr(u+1),false,true)}n+="@"}r=r.toLowerCase();u=r.lastIndexOf(":");if(u===-1){n+=t(r,false,true)}else{n+=t(r.substr(0,u),false,true);n+=r.substr(u)}}if(o){if(o.length>=3&&o.charCodeAt(0)===47&&o.charCodeAt(2)===58){const u=o.charCodeAt(1);if(u>=65&&u<=90){o=`/${String.fromCharCode(u+32)}:${o.substr(3)}`}}else if(o.length>=2&&o.charCodeAt(1)===58){const u=o.charCodeAt(0);if(u>=65&&u<=90){o=`${String.fromCharCode(u+32)}:${o.substr(2)}`}}n+=t(o,true,false)}if(l){n+="?";n+=t(l,false,false)}if(a){n+="#";n+=!e?Tn(a,false,false):a}return n}function Ss(s){try{return decodeURIComponent(s)}catch{if(s.length>3){return s.substr(0,3)+Ss(s.substr(3))}else{return s}}}const Mn=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function mt(s){if(!s.match(Mn)){return s}return s.replace(Mn,e=>Ss(e))}class Z{constructor(e,t){this.lineNumber=e;this.column=t}with(e=this.lineNumber,t=this.column){if(e===this.lineNumber&&t===this.column){return this}else{return new Z(e,t)}}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return Z.equals(this,e)}static equals(e,t){if(!e&&!t){return true}return!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return Z.isBefore(this,e)}static isBefore(e,t){if(e.lineNumber<t.lineNumber){return true}if(t.lineNumber<e.lineNumber){return false}return e.column<t.column}isBeforeOrEqual(e){return Z.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){if(e.lineNumber<t.lineNumber){return true}if(t.lineNumber<e.lineNumber){return false}return e.column<=t.column}static compare(e,t){const n=e.lineNumber|0;const i=t.lineNumber|0;if(n===i){const r=e.column|0;const o=t.column|0;return r-o}return n-i}clone(){return new Z(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Z(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber==="number"&&typeof e.column==="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}}class M{constructor(e,t,n,i){if(e>n||e===n&&t>i){this.startLineNumber=n;this.startColumn=i;this.endLineNumber=e;this.endColumn=t}else{this.startLineNumber=e;this.startColumn=t;this.endLineNumber=n;this.endColumn=i}}isEmpty(){return M.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return M.containsPosition(this,e)}static containsPosition(e,t){if(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber){return false}if(t.lineNumber===e.startLineNumber&&t.column<e.startColumn){return false}if(t.lineNumber===e.endLineNumber&&t.column>e.endColumn){return false}return true}static strictContainsPosition(e,t){if(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber){return false}if(t.lineNumber===e.startLineNumber&&t.column<=e.startColumn){return false}if(t.lineNumber===e.endLineNumber&&t.column>=e.endColumn){return false}return true}containsRange(e){return M.containsRange(this,e)}static containsRange(e,t){if(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber){return false}if(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber){return false}if(t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn){return false}if(t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn){return false}return true}strictContainsRange(e){return M.strictContainsRange(this,e)}static strictContainsRange(e,t){if(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber){return false}if(t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber){return false}if(t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn){return false}if(t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn){return false}return true}plusRange(e){return M.plusRange(this,e)}static plusRange(e,t){let n;let i;let r;let o;if(t.startLineNumber<e.startLineNumber){n=t.startLineNumber;i=t.startColumn}else if(t.startLineNumber===e.startLineNumber){n=t.startLineNumber;i=Math.min(t.startColumn,e.startColumn)}else{n=e.startLineNumber;i=e.startColumn}if(t.endLineNumber>e.endLineNumber){r=t.endLineNumber;o=t.endColumn}else if(t.endLineNumber===e.endLineNumber){r=t.endLineNumber;o=Math.max(t.endColumn,e.endColumn)}else{r=e.endLineNumber;o=e.endColumn}return new M(n,i,r,o)}intersectRanges(e){return M.intersectRanges(this,e)}static intersectRanges(e,t){let n=e.startLineNumber;let i=e.startColumn;let r=e.endLineNumber;let o=e.endColumn;const l=t.startLineNumber;const a=t.startColumn;const u=t.endLineNumber;const c=t.endColumn;if(n<l){n=l;i=a}else if(n===l){i=Math.max(i,a)}if(r>u){r=u;o=c}else if(r===u){o=Math.min(o,c)}if(n>r){return null}if(n===r&&i>o){return null}return new M(n,i,r,o)}equalsRange(e){return M.equalsRange(this,e)}static equalsRange(e,t){if(!e&&!t){return true}return!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return M.getEndPosition(this)}static getEndPosition(e){return new Z(e.endLineNumber,e.endColumn)}getStartPosition(){return M.getStartPosition(this)}static getStartPosition(e){return new Z(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new M(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new M(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return M.collapseToStart(this)}static collapseToStart(e){return new M(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return M.collapseToEnd(this)}static collapseToEnd(e){return new M(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new M(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new M(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){if(!e){return null}return new M(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}static isIRange(e){return e&&typeof e.startLineNumber==="number"&&typeof e.startColumn==="number"&&typeof e.endLineNumber==="number"&&typeof e.endColumn==="number"}static areIntersectingOrTouching(e,t){if(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn){return false}if(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn){return false}return true}static areIntersecting(e,t){if(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn){return false}if(t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn){return false}return true}static compareRangesUsingStarts(e,t){if(e&&t){const r=e.startLineNumber|0;const o=t.startLineNumber|0;if(r===o){const l=e.startColumn|0;const a=t.startColumn|0;if(l===a){const u=e.endLineNumber|0;const c=t.endLineNumber|0;if(u===c){const h=e.endColumn|0;const f=t.endColumn|0;return h-f}return u-c}return l-a}return r-o}const n=e?1:0;const i=t?1:0;return n-i}static compareRangesUsingEnds(e,t){if(e.endLineNumber===t.endLineNumber){if(e.endColumn===t.endColumn){if(e.startLineNumber===t.startLineNumber){return e.startColumn-t.startColumn}return e.startLineNumber-t.startLineNumber}return e.endColumn-t.endColumn}return e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}}function Pn(s,e){const t=Object.create(null);for(const[n,i]of Object.entries(s)){if(e(n,i)){t[n]=i}}return t}var Rn;(function(s){s[s["Left"]=1]="Left";s[s["Center"]=2]="Center";s[s["Right"]=4]="Right";s[s["Full"]=7]="Full"})(Rn||(Rn={}));var Fn;(function(s){s[s["Left"]=1]="Left";s[s["Center"]=2]="Center";s[s["Right"]=3]="Right"})(Fn||(Fn={}));var Dn;(function(s){s[s["Both"]=0]="Both";s[s["Right"]=1]="Right";s[s["Left"]=2]="Left";s[s["None"]=3]="None"})(Dn||(Dn={}));class sn{constructor(e,t){this._findMatchBrand=void 0;this.range=e;this.matches=t}}class Dr{constructor(e,t,n){this.regex=e;this.wordSeparators=t;this.simpleSearch=n}}class Br{constructor(e,t,n){this.reverseEdits=e;this.changes=t;this.trimAutoWhitespaceLineNumbers=n}}class rn{constructor(e,t){this.piece=e;this.color=t;this.size_left=0;this.lf_left=0;this.parent=this;this.left=this;this.right=this}next(){if(this.right!==C){return mn(this.right)}let e=this;while(e.parent!==C){if(e.parent.left===e){break}e=e.parent}if(e.parent===C){return C}else{return e.parent}}prev(){if(this.left!==C){return xs(this.left)}let e=this;while(e.parent!==C){if(e.parent.right===e){break}e=e.parent}if(e.parent===C){return C}else{return e.parent}}detach(){this.parent=null;this.left=null;this.right=null}}const C=new rn(null,0);C.parent=C;C.left=C;C.right=C;C.color=0;function mn(s){while(s.left!==C){s=s.left}return s}function xs(s){while(s.right!==C){s=s.right}return s}function _n(s){if(s===C){return 0}return s.size_left+s.piece.length+_n(s.right)}function Cn(s){if(s===C){return 0}return s.lf_left+s.piece.lineFeedCnt+Cn(s.right)}function Ht(){C.parent=C}function et(s,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0);t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0);e.right=t.left;if(t.left!==C){t.left.parent=e}t.parent=e.parent;if(e.parent===C){s.root=t}else if(e.parent.left===e){e.parent.left=t}else{e.parent.right=t}t.left=e;e.parent=t}function tt(s,e){const t=e.left;e.left=t.right;if(t.right!==C){t.right.parent=e}t.parent=e.parent;e.size_left-=t.size_left+(t.piece?t.piece.length:0);e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0);if(e.parent===C){s.root=t}else if(e===e.parent.right){e.parent.right=t}else{e.parent.left=t}t.right=e;e.parent=t}function _t(s,e){let t;let n;if(e.left===C){n=e;t=n.right}else if(e.right===C){n=e;t=n.left}else{n=mn(e.right);t=n.right}if(n===s.root){s.root=t;t.color=0;e.detach();Ht();s.root.parent=C;return}const i=n.color===1;if(n===n.parent.left){n.parent.left=t}else{n.parent.right=t}if(n===e){t.parent=n.parent;Xe(s,t)}else{if(n.parent===e){t.parent=n}else{t.parent=n.parent}Xe(s,t);n.left=e.left;n.right=e.right;n.parent=e.parent;n.color=e.color;if(e===s.root){s.root=n}else{if(e===e.parent.left){e.parent.left=n}else{e.parent.right=n}}if(n.left!==C){n.left.parent=n}if(n.right!==C){n.right.parent=n}n.size_left=e.size_left;n.lf_left=e.lf_left;Xe(s,n)}e.detach();if(t.parent.left===t){const o=_n(t);const l=Cn(t);if(o!==t.parent.size_left||l!==t.parent.lf_left){const a=o-t.parent.size_left;const u=l-t.parent.lf_left;t.parent.size_left=o;t.parent.lf_left=l;_e(s,t.parent,a,u)}}Xe(s,t.parent);if(i){Ht();return}let r;while(t!==s.root&&t.color===0){if(t===t.parent.left){r=t.parent.right;if(r.color===1){r.color=0;t.parent.color=1;et(s,t.parent);r=t.parent.right}if(r.left.color===0&&r.right.color===0){r.color=1;t=t.parent}else{if(r.right.color===0){r.left.color=0;r.color=1;tt(s,r);r=t.parent.right}r.color=t.parent.color;t.parent.color=0;r.right.color=0;et(s,t.parent);t=s.root}}else{r=t.parent.left;if(r.color===1){r.color=0;t.parent.color=1;tt(s,t.parent);r=t.parent.left}if(r.left.color===0&&r.right.color===0){r.color=1;t=t.parent}else{if(r.left.color===0){r.right.color=0;r.color=1;et(s,r);r=t.parent.left}r.color=t.parent.color;t.parent.color=0;r.left.color=0;tt(s,t.parent);t=s.root}}}t.color=0;Ht()}function Bn(s,e){Xe(s,e);while(e!==s.root&&e.parent.color===1){if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;if(t.color===1){e.parent.color=0;t.color=0;e.parent.parent.color=1;e=e.parent.parent}else{if(e===e.parent.right){e=e.parent;et(s,e)}e.parent.color=0;e.parent.parent.color=1;tt(s,e.parent.parent)}}else{const t=e.parent.parent.left;if(t.color===1){e.parent.color=0;t.color=0;e.parent.parent.color=1;e=e.parent.parent}else{if(e===e.parent.left){e=e.parent;tt(s,e)}e.parent.color=0;e.parent.parent.color=1;et(s,e.parent.parent)}}}s.root.color=0}function _e(s,e,t,n){while(e!==s.root&&e!==C){if(e.parent.left===e){e.parent.size_left+=t;e.parent.lf_left+=n}e=e.parent}}function Xe(s,e){let t=0;let n=0;if(e===s.root){return}while(e!==s.root&&e===e.parent.right){e=e.parent}if(e===s.root){return}e=e.parent;t=_n(e.left)-e.size_left;n=Cn(e.left)-e.lf_left;e.size_left+=t;e.lf_left+=n;while(e!==s.root&&(t!==0||n!==0)){if(e.parent.left===e){e.parent.size_left+=t;e.parent.lf_left+=n}e=e.parent}}function Un(s){if(s<0){return 0}if(s>255){return 255}return s|0}function ze(s){if(s<0){return 0}if(s>4294967295){return 4294967295}return s|0}class bn{constructor(e){const t=Un(e);this._defaultValue=t;this._asciiMap=bn._createAsciiMap(t);this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);t.fill(e);return t}set(e,t){const n=Un(t);if(e>=0&&e<256){this._asciiMap[e]=n}else{this._map.set(e,n)}}get(e){if(e>=0&&e<256){return this._asciiMap[e]}else{return this._map.get(e)||this._defaultValue}}clear(){this._asciiMap.fill(this._defaultValue);this._map.clear()}}class Ur extends bn{constructor(e,t){super(0);this._segmenter=null;this._cachedLine=null;this._cachedSegments=[];this.intlSegmenterLocales=t;if(this.intlSegmenterLocales.length>0){this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"})}else{this._segmenter=null}for(let n=0,i=e.length;n<i;n++){this.set(e.charCodeAt(n),2)}this.set(32,1);this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let n=null;for(const i of this._getIntlSegmenterWordsOnLine(e)){if(i.index>t){break}n=i}return n}findNextIntlWordAtOrAfterOffset(e,t){for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index<t){continue}return n}return null}_getIntlSegmenterWordsOnLine(e){if(!this._segmenter){return[]}if(this._cachedLine===e){return this._cachedSegments}this._cachedLine=e;this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e));return this._cachedSegments}_filterWordSegments(e){const t=[];for(const n of e){if(this._isWordLike(n)){t.push(n)}}return t}_isWordLike(e){if(e.isWordLike){return true}return false}}const $n=new rs(10);function $r(s,e){const t=`${s}/${e.join(",")}`;let n=$n.get(t);if(!n){n=new Ur(s,e);$n.set(t,n)}return n}class qr{constructor(e,t,n,i){this.searchString=e;this.isRegex=t;this.matchCase=n;this.wordSeparators=i}parseSearchRequest(){if(this.searchString===""){return null}let e;if(this.isRegex){e=zr(this.searchString)}else{e=this.searchString.indexOf("\n")>=0}let t=null;try{t=ki(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:false,multiline:e,global:true,unicode:true})}catch(i){return null}if(!t){return null}let n=!this.isRegex&&!e;if(n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()){n=this.matchCase}return new Dr(t,this.wordSeparators?$r(this.wordSeparators,[]):null,n?this.searchString:null)}}function zr(s){if(!s||s.length===0){return false}for(let e=0,t=s.length;e<t;e++){const n=s.charCodeAt(e);if(n===10){return true}if(n===92){e++;if(e>=t){break}const i=s.charCodeAt(e);if(i===110||i===114||i===87){return true}}}return false}function qn(s,e,t){if(!t){return new sn(s,null)}const n=[];for(let i=0,r=e.length;i<r;i++){n[i]=e[i]}return new sn(s,n)}function Wr(s,e,t,n,i){if(n===0){return true}const r=e.charCodeAt(n-1);if(s.get(r)!==0){return true}if(r===13||r===10){return true}if(i>0){const o=e.charCodeAt(n);if(s.get(o)!==0){return true}}return false}function Vr(s,e,t,n,i){if(n+i===t){return true}const r=e.charCodeAt(n+i);if(s.get(r)!==0){return true}if(r===13||r===10){return true}if(i>0){const o=e.charCodeAt(n+i-1);if(s.get(o)!==0){return true}}return false}function As(s,e,t,n,i){return Wr(s,e,t,n,i)&&Vr(s,e,t,n,i)}class Hr{constructor(e,t){this._wordSeparators=e;this._searchRegex=t;this._prevMatchStartIndex=-1;this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e;this._prevMatchStartIndex=-1;this._prevMatchLength=0}next(e){const t=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t){return null}n=this._searchRegex.exec(e);if(!n){return null}const i=n.index;const r=n[0].length;if(i===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){if(Ui(e,t,this._searchRegex.lastIndex)>65535){this._searchRegex.lastIndex+=2}else{this._searchRegex.lastIndex+=1}continue}return null}this._prevMatchStartIndex=i;this._prevMatchLength=r;if(!this._wordSeparators||As(this._wordSeparators,e,t,i,r)){return n}}while(n);return null}}const ge=65535;function Ns(s){let e;if(s[s.length-1]<65536){e=new Uint16Array(s.length)}else{e=new Uint32Array(s.length)}e.set(s,0);return e}class jr{constructor(e,t,n,i,r){this.lineStarts=e;this.cr=t;this.lf=n;this.crlf=i;this.isBasicASCII=r}}function Ce(s,e=true){const t=[0];let n=1;for(let i=0,r=s.length;i<r;i++){const o=s.charCodeAt(i);if(o===13){if(i+1<r&&s.charCodeAt(i+1)===10){t[n++]=i+2;i++}else{t[n++]=i+1}}else if(o===10){t[n++]=i+1}}if(e){return Ns(t)}else{return t}}function Gr(s,e){s.length=0;s[0]=0;let t=1;let n=0,i=0,r=0;let o=true;for(let a=0,u=e.length;a<u;a++){const c=e.charCodeAt(a);if(c===13){if(a+1<u&&e.charCodeAt(a+1)===10){r++;s[t++]=a+2;a++}else{n++;s[t++]=a+1}}else if(c===10){i++;s[t++]=a+1}else{if(o){if(c!==9&&(c<32||c>126)){o=false}}}}const l=new jr(Ns(s),n,i,r,o);s.length=0;return l}class ee{constructor(e,t,n,i,r){this.bufferIndex=e;this.start=t;this.end=n;this.lineFeedCnt=i;this.length=r}}class Te{constructor(e,t){this.buffer=e;this.lineStarts=t}}class Kr{constructor(e,t){this._pieces=[];this._tree=e;this._BOM=t;this._index=0;if(e.root!==C){e.iterate(e.root,n=>{if(n!==C){this._pieces.push(n.piece)}return true})}}read(){if(this._pieces.length===0){if(this._index===0){this._index++;return this._BOM}else{return null}}if(this._index>this._pieces.length-1){return null}if(this._index===0){return this._BOM+this._tree.getPieceContent(this._pieces[this._index++])}return this._tree.getPieceContent(this._pieces[this._index++])}}class Qr{constructor(e){this._limit=e;this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e){return n}}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e){return n}}return null}set(e){if(this._cache.length>=this._limit){this._cache.shift()}this._cache.push(e)}validate(e){let t=false;const n=this._cache;for(let i=0;i<n.length;i++){const r=n[i];if(r.node.parent===null||r.nodeStartOffset>=e){n[i]=null;t=true;continue}}if(t){const i=[];for(const r of n){if(r!==null){i.push(r)}}this._cache=i}}}class Yr{constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new Te("",[0])];this._lastChangeBufferPos={line:0,column:0};this.root=C;this._lineCnt=1;this._length=0;this._EOL=t;this._EOLLength=t.length;this._EOLNormalized=n;let i=null;for(let r=0,o=e.length;r<o;r++){if(e[r].buffer.length>0){if(!e[r].lineStarts){e[r].lineStarts=Ce(e[r].buffer)}const l=new ee(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]);i=this.rbInsertRight(i,l)}}this._searchCache=new Qr(1);this._lastVisitedLine={lineNumber:0,value:""};this.computeBufferMetadata()}normalizeEOL(e){const t=ge;const n=t-Math.floor(t/3);const i=n*2;let r="";let o=0;const l=[];this.iterate(this.root,a=>{const u=this.getNodeContent(a);const c=u.length;if(o<=n||o+c<i){r+=u;o+=c;return true}const h=r.replace(/\r\n|\r|\n/g,e);l.push(new Te(h,Ce(h)));r=u;o=c;return true});if(o>0){const a=r.replace(/\r\n|\r|\n/g,e);l.push(new Te(a,Ce(a)))}this.create(l,e,true)}getEOL(){return this._EOL}setEOL(e){this._EOL=e;this._EOLLength=this._EOL.length;this.normalizeEOL(e)}createSnapshot(e){return new Kr(this,e)}equal(e){if(this.getLength()!==e.getLength()){return false}if(this.getLineCount()!==e.getLineCount()){return false}let t=0;const n=this.iterate(this.root,i=>{if(i===C){return true}const r=this.getNodeContent(i);const o=r.length;const l=e.nodeAt(t);const a=e.nodeAt(t+o);const u=e.getValueInRange2(l,a);t+=o;return r===u});return n}getOffsetAt(e,t){let n=0;let i=this.root;while(i!==C){if(i.left!==C&&i.lf_left+1>=e){i=i.left}else if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;const r=this.getAccumulatedValue(i,e-i.lf_left-2);return n+=r+t-1}else{e-=i.lf_left+i.piece.lineFeedCnt;n+=i.size_left+i.piece.length;i=i.right}}return n}getPositionAt(e){e=Math.floor(e);e=Math.max(0,e);let t=this.root;let n=0;const i=e;while(t!==C){if(t.size_left!==0&&t.size_left>=e){t=t.left}else if(t.size_left+t.piece.length>=e){const r=this.getIndexOf(t,e-t.size_left);n+=t.lf_left+r.index;if(r.index===0){const o=this.getOffsetAt(n+1,1);const l=i-o;return new Z(n+1,l+1)}return new Z(n+1,r.remainder+1)}else{e-=t.size_left+t.piece.length;n+=t.lf_left+t.piece.lineFeedCnt;if(t.right===C){const r=this.getOffsetAt(n+1,1);const o=i-e-r;return new Z(n+1,o+1)}else{t=t.right}}}return new Z(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn){return""}const n=this.nodeAt2(e.startLineNumber,e.startColumn);const i=this.nodeAt2(e.endLineNumber,e.endColumn);const r=this.getValueInRange2(n,i);if(t){if(t!==this._EOL||!this._EOLNormalized){return r.replace(/\r\n|\r|\n/g,t)}if(t===this.getEOL()&&this._EOLNormalized){return r}return r.replace(/\r\n|\r|\n/g,t)}return r}getValueInRange2(e,t){if(e.node===t.node){const l=e.node;const a=this._buffers[l.piece.bufferIndex].buffer;const u=this.offsetInBuffer(l.piece.bufferIndex,l.piece.start);return a.substring(u+e.remainder,u+t.remainder)}let n=e.node;const i=this._buffers[n.piece.bufferIndex].buffer;const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);let o=i.substring(r+e.remainder,r+n.piece.length);n=n.next();while(n!==C){const l=this._buffers[n.piece.bufferIndex].buffer;const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){o+=l.substring(a,a+t.remainder);break}else{o+=l.substr(a,n.piece.length)}n=n.next()}return o}getLinesContent(){const e=[];let t=0;let n="";let i=false;this.iterate(this.root,r=>{if(r===C){return true}const o=r.piece;let l=o.length;if(l===0){return true}const a=this._buffers[o.bufferIndex].buffer;const u=this._buffers[o.bufferIndex].lineStarts;const c=o.start.line;const h=o.end.line;let f=u[c]+o.start.column;if(i){if(a.charCodeAt(f)===10){f++;l--}e[t++]=n;n="";i=false;if(l===0){return true}}if(c===h){if(!this._EOLNormalized&&a.charCodeAt(f+l-1)===13){i=true;n+=a.substr(f,l-1)}else{n+=a.substr(f,l)}return true}n+=this._EOLNormalized?a.substring(f,Math.max(f,u[c+1]-this._EOLLength)):a.substring(f,u[c+1]).replace(/(\r\n|\r|\n)$/,"");e[t++]=n;for(let d=c+1;d<h;d++){n=this._EOLNormalized?a.substring(u[d],u[d+1]-this._EOLLength):a.substring(u[d],u[d+1]).replace(/(\r\n|\r|\n)$/,"");e[t++]=n}if(!this._EOLNormalized&&a.charCodeAt(u[h]+o.end.column-1)===13){i=true;if(o.end.column===0){t--}else{n=a.substr(u[h],o.end.column-1)}}else{n=a.substr(u[h],o.end.column)}return true});if(i){e[t++]=n;n=""}e[t++]=n;return e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){if(this._lastVisitedLine.lineNumber===e){return this._lastVisitedLine.value}this._lastVisitedLine.lineNumber=e;if(e===this._lineCnt){this._lastVisitedLine.value=this.getLineRawContent(e)}else if(this._EOLNormalized){this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength)}else{this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")}return this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t){return 0}const n=this._buffers[t.piece.bufferIndex];const i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}else{const t=this._buffers[e.node.piece.bufferIndex];const n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start);const i=n+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){const n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const t=this.nodeAt(e);return this._getCharCode(t)}getNearestChunk(e){const t=this.nodeAt(e);if(t.remainder===t.node.piece.length){const n=t.node.next();if(!n||n===C){return""}const i=this._buffers[n.piece.bufferIndex];const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.buffer.substring(r,r+n.piece.length)}else{const n=this._buffers[t.node.piece.bufferIndex];const i=this.offsetInBuffer(t.node.piece.bufferIndex,t.node.piece.start);const r=i+t.remainder;const o=i+t.node.piece.length;return n.buffer.substring(r,o)}}findMatchesInNode(e,t,n,i,r,o,l,a,u,c,h){const f=this._buffers[e.piece.bufferIndex];const d=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);const w=this.offsetInBuffer(e.piece.bufferIndex,r);const m=this.offsetInBuffer(e.piece.bufferIndex,o);let g;const v={line:0,column:0};let N;let x;if(t._wordSeparators){N=f.buffer.substring(w,m);x=_=>_+w;t.reset(0)}else{N=f.buffer;x=_=>_;t.reset(w)}do{g=t.next(N);if(g){if(x(g.index)>=m){return c}this.positionInBuffer(e,x(g.index)-d,v);const _=this.getLineFeedCnt(e.piece.bufferIndex,r,v);const E=v.line===r.line?v.column-r.column+i:v.column+1;const A=E+g[0].length;h[c++]=qn(new M(n+_,E,n+_,A),g,a);if(x(g.index)+g[0].length>=m){return c}if(c>=u){return c}}}while(g);return c}findMatchesLineByLine(e,t,n,i){const r=[];let o=0;const l=new Hr(t.wordSeparators,t.regex);let a=this.nodeAt2(e.startLineNumber,e.startColumn);if(a===null){return[]}const u=this.nodeAt2(e.endLineNumber,e.endColumn);if(u===null){return[]}let c=this.positionInBuffer(a.node,a.remainder);const h=this.positionInBuffer(u.node,u.remainder);if(a.node===u.node){this.findMatchesInNode(a.node,l,e.startLineNumber,e.startColumn,c,h,t,n,i,o,r);return r}let f=e.startLineNumber;let d=a.node;while(d!==u.node){const m=this.getLineFeedCnt(d.piece.bufferIndex,c,d.piece.end);if(m>=1){const v=this._buffers[d.piece.bufferIndex].lineStarts;const N=this.offsetInBuffer(d.piece.bufferIndex,d.piece.start);const x=v[c.line+m];const _=f===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(d,l,f,_,c,this.positionInBuffer(d,x-N),t,n,i,o,r);if(o>=i){return r}f+=m}const g=f===e.startLineNumber?e.startColumn-1:0;if(f===e.endLineNumber){const v=this.getLineContent(f).substring(g,e.endColumn-1);o=this._findMatchesInLine(t,l,v,e.endLineNumber,g,o,r,n,i);return r}o=this._findMatchesInLine(t,l,this.getLineContent(f).substr(g),f,g,o,r,n,i);if(o>=i){return r}f++;a=this.nodeAt2(f,1);d=a.node;c=this.positionInBuffer(a.node,a.remainder)}if(f===e.endLineNumber){const m=f===e.startLineNumber?e.startColumn-1:0;const g=this.getLineContent(f).substring(m,e.endColumn-1);o=this._findMatchesInLine(t,l,g,e.endLineNumber,m,o,r,n,i);return r}const w=f===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(u.node,l,f,w,c,h,t,n,i,o,r);return r}_findMatchesInLine(e,t,n,i,r,o,l,a,u){const c=e.wordSeparators;if(!a&&e.simpleSearch){const f=e.simpleSearch;const d=f.length;const w=n.length;let m=-d;while((m=n.indexOf(f,m+d))!==-1){if(!c||As(c,n,w,m,d)){l[o++]=new sn(new M(i,m+1+r,i,m+1+d+r),null);if(o>=u){return o}}}return o}let h;t.reset(0);do{h=t.next(n);if(h){l[o++]=qn(new M(i,h.index+1+r,i,h.index+1+h[0].length+r),h,a);if(o>=u){return o}}}while(h);return o}insert(e,t,n=false){this._EOLNormalized=this._EOLNormalized&&n;this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(this.root!==C){const{node:i,remainder:r,nodeStartOffset:o}=this.nodeAt(e);const l=i.piece;const a=l.bufferIndex;const u=this.positionInBuffer(i,r);if(i.piece.bufferIndex===0&&l.end.line===this._lastChangeBufferPos.line&&l.end.column===this._lastChangeBufferPos.column&&o+l.length===e&&t.length<ge){this.appendToNode(i,t);this.computeBufferMetadata();return}if(o===e){this.insertContentToNodeLeft(t,i);this._searchCache.validate(e)}else if(o+i.piece.length>e){const c=[];let h=new ee(l.bufferIndex,u,l.end,this.getLineFeedCnt(l.bufferIndex,u,l.end),this.offsetInBuffer(a,l.end)-this.offsetInBuffer(a,u));if(this.shouldCheckCRLF()&&this.endWithCR(t)){const w=this.nodeCharCodeAt(i,r);if(w===10){const m={line:h.start.line+1,column:0};h=new ee(h.bufferIndex,m,h.end,this.getLineFeedCnt(h.bufferIndex,m,h.end),h.length-1);t+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){const w=this.nodeCharCodeAt(i,r-1);if(w===13){const m=this.positionInBuffer(i,r-1);this.deleteNodeTail(i,m);t="\r"+t;if(i.piece.length===0){c.push(i)}}else{this.deleteNodeTail(i,u)}}else{this.deleteNodeTail(i,u)}const f=this.createNewPieces(t);if(h.length>0){this.rbInsertRight(i,h)}let d=i;for(let w=0;w<f.length;w++){d=this.rbInsertRight(d,f[w])}this.deleteNodes(c)}else{this.insertContentToNodeRight(t,i)}}else{const i=this.createNewPieces(t);let r=this.rbInsertLeft(null,i[0]);for(let o=1;o<i.length;o++){r=this.rbInsertRight(r,i[o])}}this.computeBufferMetadata()}delete(e,t){this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(t<=0||this.root===C){return}const n=this.nodeAt(e);const i=this.nodeAt(e+t);const r=n.node;const o=i.node;if(r===o){const f=this.positionInBuffer(r,n.remainder);const d=this.positionInBuffer(r,i.remainder);if(n.nodeStartOffset===e){if(t===r.piece.length){const w=r.next();_t(this,r);this.validateCRLFWithPrevNode(w);this.computeBufferMetadata();return}this.deleteNodeHead(r,d);this._searchCache.validate(e);this.validateCRLFWithPrevNode(r);this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+t){this.deleteNodeTail(r,f);this.validateCRLFWithNextNode(r);this.computeBufferMetadata();return}this.shrinkNode(r,f,d);this.computeBufferMetadata();return}const l=[];const a=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,a);this._searchCache.validate(e);if(r.piece.length===0){l.push(r)}const u=this.positionInBuffer(o,i.remainder);this.deleteNodeHead(o,u);if(o.piece.length===0){l.push(o)}const c=r.next();for(let f=c;f!==C&&f!==o;f=f.next()){l.push(f)}const h=r.piece.length===0?r.prev():r;this.deleteNodes(l);this.validateCRLFWithNextNode(h);this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const o=t.piece;const l={line:o.start.line+1,column:0};const a=new ee(o.bufferIndex,l,o.end,this.getLineFeedCnt(o.bufferIndex,l,o.end),o.length-1);t.piece=a;e+="\n";_e(this,t,-1,-1);if(t.piece.length===0){n.push(t)}}const i=this.createNewPieces(e);let r=this.rbInsertLeft(t,i[i.length-1]);for(let o=i.length-2;o>=0;o--){r=this.rbInsertLeft(r,i[o])}this.validateCRLFWithPrevNode(r);this.deleteNodes(n)}insertContentToNodeRight(e,t){if(this.adjustCarriageReturnFromNext(e,t)){e+="\n"}const n=this.createNewPieces(e);const i=this.rbInsertRight(t,n[0]);let r=i;for(let o=1;o<n.length;o++){r=this.rbInsertRight(r,n[o])}this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){const i=e.piece;const r=e.piece.bufferIndex;const o=this._buffers[r].lineStarts;const l=o[i.start.line]+i.start.column;const a=l+t;let u=i.start.line;let c=i.end.line;let h=0;let f=0;let d=0;while(u<=c){h=u+(c-u)/2|0;d=o[h];if(h===c){break}f=o[h+1];if(a<d){c=h-1}else if(a>=f){u=h+1}else{break}}if(n){n.line=h;n.column=a-d;return null}return{line:h,column:a-d}}getLineFeedCnt(e,t,n){if(n.column===0){return n.line-t.line}const i=this._buffers[e].lineStarts;if(n.line===i.length-1){return n.line-t.line}const r=i[n.line+1];const o=i[n.line]+n.column;if(r>o+1){return n.line-t.line}const l=o-1;const a=this._buffers[e].buffer;if(a.charCodeAt(l)===13){return n.line-t.line+1}else{return n.line-t.line}}offsetInBuffer(e,t){const n=this._buffers[e].lineStarts;return n[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++){_t(this,e[t])}}createNewPieces(e){if(e.length>ge){const c=[];while(e.length>ge){const f=e.charCodeAt(ge-1);let d;if(f===13||f>=55296&&f<=56319){d=e.substring(0,ge-1);e=e.substring(ge-1)}else{d=e.substring(0,ge);e=e.substring(ge)}const w=Ce(d);c.push(new ee(this._buffers.length,{line:0,column:0},{line:w.length-1,column:d.length-w[w.length-1]},w.length-1,d.length));this._buffers.push(new Te(d,w))}const h=Ce(e);c.push(new ee(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length));this._buffers.push(new Te(e,h));return c}let t=this._buffers[0].buffer.length;const n=Ce(e,false);let i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1};i=this._lastChangeBufferPos;for(let c=0;c<n.length;c++){n[c]+=t+1}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+="_"+e;t+=1}else{if(t!==0){for(let c=0;c<n.length;c++){n[c]+=t}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length;const o=this._buffers[0].lineStarts.length-1;const l=r-this._buffers[0].lineStarts[o];const a={line:o,column:l};const u=new ee(0,i,a,this.getLineFeedCnt(0,i,a),r-t);this._lastChangeBufferPos=a;return[u]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,t=0){let n=this.root;let i="";const r=this._searchCache.get2(e);if(r){n=r.node;const o=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1);const l=this._buffers[n.piece.bufferIndex].buffer;const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e){i=l.substring(a+o,a+n.piece.length)}else{const u=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return l.substring(a+o,a+u-t)}}else{let o=0;const l=e;while(n!==C){if(n.left!==C&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const a=this.getAccumulatedValue(n,e-n.lf_left-2);const u=this.getAccumulatedValue(n,e-n.lf_left-1);const c=this._buffers[n.piece.bufferIndex].buffer;const h=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);o+=n.size_left;this._searchCache.set({node:n,nodeStartOffset:o,nodeStartLineNumber:l-(e-1-n.lf_left)});return c.substring(h+a,h+u-t)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const a=this.getAccumulatedValue(n,e-n.lf_left-2);const u=this._buffers[n.piece.bufferIndex].buffer;const c=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=u.substring(c+a,c+n.piece.length);break}else{e-=n.lf_left+n.piece.lineFeedCnt;o+=n.size_left+n.piece.length;n=n.right}}}n=n.next();while(n!==C){const o=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){const l=this.getAccumulatedValue(n,0);const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=o.substring(a,a+l-t);return i}else{const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=o.substr(l,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root;let t=1;let n=0;while(e!==C){t+=e.lf_left+e.piece.lineFeedCnt;n+=e.size_left+e.piece.length;e=e.right}this._lineCnt=t;this._length=n;this._searchCache.validate(this._length)}getIndexOf(e,t){const n=e.piece;const i=this.positionInBuffer(e,t);const r=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){const o=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(o!==r){return{index:o,remainder:0}}}return{index:r,remainder:i.column}}getAccumulatedValue(e,t){if(t<0){return 0}const n=e.piece;const i=this._buffers[n.bufferIndex].lineStarts;const r=n.start.line+t+1;if(r>n.end.line){return i[n.end.line]+n.end.column-i[n.start.line]-n.start.column}else{return i[r]-i[n.start.line]-n.start.column}}deleteNodeTail(e,t){const n=e.piece;const i=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=t;const l=this.offsetInBuffer(n.bufferIndex,o);const a=this.getLineFeedCnt(n.bufferIndex,n.start,o);const u=a-i;const c=l-r;const h=n.length+c;e.piece=new ee(n.bufferIndex,n.start,o,a,h);_e(this,e,c,u)}deleteNodeHead(e,t){const n=e.piece;const i=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.start);const o=t;const l=this.getLineFeedCnt(n.bufferIndex,o,n.end);const a=this.offsetInBuffer(n.bufferIndex,o);const u=l-i;const c=r-a;const h=n.length+c;e.piece=new ee(n.bufferIndex,o,n.end,l,h);_e(this,e,c,u)}shrinkNode(e,t,n){const i=e.piece;const r=i.start;const o=i.end;const l=i.length;const a=i.lineFeedCnt;const u=t;const c=this.getLineFeedCnt(i.bufferIndex,i.start,u);const h=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,r);e.piece=new ee(i.bufferIndex,i.start,u,c,h);_e(this,e,h-l,c-a);const f=new ee(i.bufferIndex,n,o,this.getLineFeedCnt(i.bufferIndex,n,o),this.offsetInBuffer(i.bufferIndex,o)-this.offsetInBuffer(i.bufferIndex,n));const d=this.rbInsertRight(e,f);this.validateCRLFWithPrevNode(d)}appendToNode(e,t){if(this.adjustCarriageReturnFromNext(t,e)){t+="\n"}const n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e);const i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const r=Ce(t,false);for(let d=0;d<r.length;d++){r[d]+=i}if(n){const d=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop();this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-d}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1;const l=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o];const a={line:o,column:l};const u=e.piece.length+t.length;const c=e.piece.lineFeedCnt;const h=this.getLineFeedCnt(0,e.piece.start,a);const f=h-c;e.piece=new ee(e.piece.bufferIndex,e.piece.start,a,h,u);this._lastChangeBufferPos=a;_e(this,e,t.length,f)}nodeAt(e){let t=this.root;const n=this._searchCache.get(e);if(n){return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset}}let i=0;while(t!==C){if(t.size_left>e){t=t.left}else if(t.size_left+t.piece.length>=e){i+=t.size_left;const r={node:t,remainder:e-t.size_left,nodeStartOffset:i};this._searchCache.set(r);return r}else{e-=t.size_left+t.piece.length;i+=t.size_left+t.piece.length;t=t.right}}return null}nodeAt2(e,t){let n=this.root;let i=0;while(n!==C){if(n.left!==C&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);const o=this.getAccumulatedValue(n,e-n.lf_left-1);i+=n.size_left;return{node:n,remainder:Math.min(r+t-1,o),nodeStartOffset:i}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+t-1<=n.piece.length){return{node:n,remainder:r+t-1,nodeStartOffset:i}}else{t-=n.piece.length-r;break}}else{e-=n.lf_left+n.piece.lineFeedCnt;i+=n.size_left+n.piece.length;n=n.right}}n=n.next();while(n!==C){if(n.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(n,0);const o=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,r),nodeStartOffset:o}}else{if(n.piece.length>=t-1){const r=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:r}}else{t-=n.piece.length}}n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1){return-1}const n=this._buffers[e.piece.bufferIndex];const i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e){return 0}let t=e.size_left;while(e!==this.root){if(e.parent.right===e){t+=e.parent.size_left+e.parent.piece.length}e=e.parent}return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL==="\n")}startWithLF(e){if(typeof e==="string"){return e.charCodeAt(0)===10}if(e===C||e.piece.lineFeedCnt===0){return false}const t=e.piece;const n=this._buffers[t.bufferIndex].lineStarts;const i=t.start.line;const r=n[i]+t.start.column;if(i===n.length-1){return false}const o=n[i+1];if(o>r+1){return false}return this._buffers[t.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){if(typeof e==="string"){return e.charCodeAt(e.length-1)===13}if(e===C||e.piece.lineFeedCnt===0){return false}return this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();if(this.endWithCR(t)){this.fixCRLF(t,e)}}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();if(this.startWithLF(t)){this.fixCRLF(e,t)}}}fixCRLF(e,t){const n=[];const i=this._buffers[e.piece.bufferIndex].lineStarts;let r;if(e.piece.end.column===0){r={line:e.piece.end.line-1,column:i[e.piece.end.line]-i[e.piece.end.line-1]-1}}else{r={line:e.piece.end.line,column:e.piece.end.column-1}}const o=e.piece.length-1;const l=e.piece.lineFeedCnt-1;e.piece=new ee(e.piece.bufferIndex,e.piece.start,r,l,o);_e(this,e,-1,-1);if(e.piece.length===0){n.push(e)}const a={line:t.piece.start.line+1,column:0};const u=t.piece.length-1;const c=this.getLineFeedCnt(t.piece.bufferIndex,a,t.piece.end);t.piece=new ee(t.piece.bufferIndex,a,t.piece.end,c,u);_e(this,t,-1,-1);if(t.piece.length===0){n.push(t)}const h=this.createNewPieces("\r\n");this.rbInsertRight(e,h[0]);for(let f=0;f<n.length;f++){_t(this,n[f])}}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const n=t.next();if(this.startWithLF(n)){e+="\n";if(n.piece.length===1){_t(this,n)}else{const i=n.piece;const r={line:i.start.line+1,column:0};const o=i.length-1;const l=this.getLineFeedCnt(i.bufferIndex,r,i.end);n.piece=new ee(i.bufferIndex,r,i.end,l,o);_e(this,n,-1,-1)}return true}}return false}iterate(e,t){if(e===C){return t(C)}const n=this.iterate(e.left,t);if(!n){return n}return t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===C){return""}const t=this._buffers[e.piece.bufferIndex];const n=e.piece;const i=this.offsetInBuffer(n.bufferIndex,n.start);const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=t.buffer.substring(i,r);return o}getPieceContent(e){const t=this._buffers[e.bufferIndex];const n=this.offsetInBuffer(e.bufferIndex,e.start);const i=this.offsetInBuffer(e.bufferIndex,e.end);const r=t.buffer.substring(n,i);return r}rbInsertRight(e,t){const n=new rn(t,1);n.left=C;n.right=C;n.parent=C;n.size_left=0;n.lf_left=0;const i=this.root;if(i===C){this.root=n;n.color=0}else if(e.right===C){e.right=n;n.parent=e}else{const r=mn(e.right);r.left=n;n.parent=r}Bn(this,n);return n}rbInsertLeft(e,t){const n=new rn(t,1);n.left=C;n.right=C;n.parent=C;n.size_left=0;n.lf_left=0;if(this.root===C){this.root=n;n.color=0}else if(e.left===C){e.left=n;n.parent=e}else{const i=xs(e.left);i.right=n;n.parent=i}Bn(this,n);return n}getContentOfSubTree(e){let t="";this.iterate(e,n=>{t+=this.getNodeContent(n);return true});return t}}function jt(s){let e=0;let t=0;let n=0;let i=0;for(let r=0,o=s.length;r<o;r++){const l=s.charCodeAt(r);if(l===13){if(e===0){t=r}e++;if(r+1<o&&s.charCodeAt(r+1)===10){i|=2;r++}else{i|=3}n=r+1}else if(l===10){i|=1;if(e===0){t=r}e++;n=r+1}}if(e===0){t=s.length}return[e,t,s.length-n,i]}let Gt;function Jr(){if(!Gt){Gt=new TextDecoder("UTF-16LE")}return Gt}function Zr(s,e,t){const n=new Uint16Array(s.buffer,e,t);if(t>0&&(n[0]===65279||n[0]===65534)){return Xr(s,e,t)}return Jr().decode(n)}function Xr(s,e,t){const n=[];let i=0;for(let r=0;r<t;r++){const o=sr(s,e);e+=2;n[i++]=String.fromCharCode(o)}return n.join("")}function Ct(s){return s.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class ae{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,n,i){this.oldPosition=e;this.oldText=t;this.newPosition=n;this.newText=i}toString(){if(this.oldText.length===0){return`(insert@${this.oldPosition} "${Ct(this.newText)}")`}if(this.newText.length===0){return`(delete@${this.oldPosition} "${Ct(this.oldText)}")`}return`(replace@${this.oldPosition} "${Ct(this.oldText)}" with "${Ct(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){const i=t.length;Et(e,i,n);n+=4;for(let r=0;r<i;r++){ir(e,t.charCodeAt(r),n);n+=2}return n}static _readString(e,t){const n=vt(e,t);t+=4;return Zr(e,t,n)}writeSize(){return 4+4+ae._writeStringSize(this.oldText)+ae._writeStringSize(this.newText)}write(e,t){Et(e,this.oldPosition,t);t+=4;Et(e,this.newPosition,t);t+=4;t=ae._writeString(e,this.oldText,t);t=ae._writeString(e,this.newText,t);return t}static read(e,t,n){const i=vt(e,t);t+=4;const r=vt(e,t);t+=4;const o=ae._readString(e,t);t+=ae._writeStringSize(o);const l=ae._readString(e,t);t+=ae._writeStringSize(l);n.push(new ae(i,o,r,l));return t}}class He extends At{constructor(e,t,n,i,r,o,l){super();this._onDidChangeContent=this._register(new ue);this.onDidChangeContent=this._onDidChangeContent.event;this._BOM=t;this._mightContainNonBasicASCII=!o;this._mightContainRTL=i;this._mightContainUnusualLineTerminators=r;this._pieceTree=new Yr(e,n,l)}equals(e){if(!(e instanceof He)){return false}if(this._BOM!==e._BOM){return false}if(this.getEOL()!==e.getEOL()){return false}return this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=false}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const n=e+t;const i=this.getPositionAt(e);const r=this.getPositionAt(n);return new M(i.lineNumber,i.column,r.lineNumber,r.column)}getValueInRange(e,t=0){if(e.isEmpty()){return""}const n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty()){return 0}if(e.startLineNumber===e.endLineNumber){return e.endColumn-e.startColumn}const n=this.getOffsetAt(e.startLineNumber,e.startColumn);const i=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(t);const l=this.getEOL();if(o.length!==l.length){const a=o.length-l.length;const u=e.endLineNumber-e.startLineNumber;r=a*u}return i-n+r}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0;const i=e.startLineNumber;const r=e.endLineNumber;for(let o=i;o<=r;o++){const l=this.getLineContent(o);const a=o===i?e.startColumn-1:0;const u=o===r?e.endColumn-1:l.length;for(let c=a;c<u;c++){if(gs(l.charCodeAt(c))){n=n+1;c=c+1}else{n=n+1}}}n+=this._getEndOfLine(t).length*(r-i);return n}return this.getValueLengthInRange(e,t)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const t=Ut(this.getLineContent(e));if(t===-1){return 0}return t+1}getLineLastNonWhitespaceColumn(e){const t=Ti(this.getLineContent(e));if(t===-1){return 0}return t+2}_getEndOfLine(e){switch(e){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL;let r=this._mightContainUnusualLineTerminators;let o=this._mightContainNonBasicASCII;let l=true;let a=[];for(let m=0;m<e.length;m++){const g=e[m];if(l&&g._isTracked){l=false}const v=g.range;if(g.text){let A=true;if(!o){A=!zi(g.text);o=A}if(!i&&A){i=ps(g.text)}if(!r&&A){r=ms(g.text)}}let N="";let x=0;let _=0;let E=0;if(g.text){let A;[x,_,E,A]=jt(g.text);const R=this.getEOL();const T=R==="\r\n"?2:1;if(A===0||A===T){N=g.text}else{N=g.text.replace(/\r\n|\r|\n/g,R)}}a[m]={sortIndex:m,identifier:g.identifier||null,range:v,rangeOffset:this.getOffsetAt(v.startLineNumber,v.startColumn),rangeLength:this.getValueLengthInRange(v),text:N,eolCount:x,firstLineLength:_,lastLineLength:E,forceMoveMarkers:Boolean(g.forceMoveMarkers),isAutoWhitespaceEdit:g.isAutoWhitespaceEdit||false}}a.sort(He._sortOpsAscending);let u=false;for(let m=0,g=a.length-1;m<g;m++){const v=a[m].range.getEndPosition();const N=a[m+1].range.getStartPosition();if(N.isBeforeOrEqual(v)){if(N.isBefore(v)){throw new Error("Overlapping ranges are not allowed!")}u=true}}if(l){a=this._reduceOperations(a)}const c=n||t?He._getInverseEditRanges(a):[];const h=[];if(t){for(let m=0;m<a.length;m++){const g=a[m];const v=c[m];if(g.isAutoWhitespaceEdit&&g.range.isEmpty()){for(let N=v.startLineNumber;N<=v.endLineNumber;N++){let x="";if(N===v.startLineNumber){x=this.getLineContent(g.range.startLineNumber);if(Ut(x)!==-1){continue}}h.push({lineNumber:N,oldContent:x})}}}}let f=null;if(n){let m=0;f=[];for(let g=0;g<a.length;g++){const v=a[g];const N=c[g];const x=this.getValueInRange(v.range);const _=v.rangeOffset+m;m+=v.text.length-x.length;f[g]={sortIndex:v.sortIndex,identifier:v.identifier,range:N,text:x,textChange:new ae(v.rangeOffset,x,_,v.text)}}if(!u){f.sort((g,v)=>g.sortIndex-v.sortIndex)}}this._mightContainRTL=i;this._mightContainUnusualLineTerminators=r;this._mightContainNonBasicASCII=o;const d=this._doApplyEdits(a);let w=null;if(t&&h.length>0){h.sort((m,g)=>g.lineNumber-m.lineNumber);w=[];for(let m=0,g=h.length;m<g;m++){const v=h[m].lineNumber;if(m>0&&h[m-1].lineNumber===v){continue}const N=h[m].oldContent;const x=this.getLineContent(v);if(x.length===0||x===N||Ut(x)!==-1){continue}w.push(v)}}this._onDidChangeContent.fire();return new Br(f,d,w)}_reduceOperations(e){if(e.length<1e3){return e}return[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=false;const n=e[0].range;const i=e[e.length-1].range;const r=new M(n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn);let o=n.startLineNumber;let l=n.startColumn;const a=[];for(let d=0,w=e.length;d<w;d++){const m=e[d];const g=m.range;t=t||m.forceMoveMarkers;a.push(this.getValueInRange(new M(o,l,g.startLineNumber,g.startColumn)));if(m.text.length>0){a.push(m.text)}o=g.endLineNumber;l=g.endColumn}const u=a.join("");const[c,h,f]=jt(u);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,0),text:u,eolCount:c,firstLineLength:h,lastLineLength:f,forceMoveMarkers:t,isAutoWhitespaceEdit:false}}_doApplyEdits(e){e.sort(He._sortOpsDescending);const t=[];for(let n=0;n<e.length;n++){const i=e[n];const r=i.range.startLineNumber;const o=i.range.startColumn;const l=i.range.endLineNumber;const a=i.range.endColumn;if(r===l&&o===a&&i.text.length===0){continue}if(i.text){this._pieceTree.delete(i.rangeOffset,i.rangeLength);this._pieceTree.insert(i.rangeOffset,i.text,true)}else{this._pieceTree.delete(i.rangeOffset,i.rangeLength)}const u=new M(r,o,l,a);t.push({range:u,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,t){const n=e.startLineNumber;const i=e.startColumn;const[r,o,l]=jt(t);let a;if(t.length>0){const u=r+1;if(u===1){a=new M(n,i,n,i+o)}else{a=new M(n,i,n+u-1,l+1)}}else{a=new M(n,i,n,i)}return a}static _getInverseEditRanges(e){const t=[];let n=0;let i=0;let r=null;for(let o=0,l=e.length;o<l;o++){const a=e[o];let u;let c;if(r){if(r.range.endLineNumber===a.range.startLineNumber){u=n;c=i+(a.range.startColumn-r.range.endColumn)}else{u=n+(a.range.startLineNumber-r.range.endLineNumber);c=a.range.startColumn}}else{u=a.range.startLineNumber;c=a.range.startColumn}let h;if(a.text.length>0){const f=a.eolCount+1;if(f===1){h=new M(u,c,u,c+a.firstLineLength)}else{h=new M(u,c,u+f-1,a.lastLineLength+1)}}else{h=new M(u,c,u,c)}n=h.endLineNumber;i=h.endColumn;t.push(h);r=a}return t}static _sortOpsAscending(e,t){const n=M.compareRangesUsingEnds(e.range,t.range);if(n===0){return e.sortIndex-t.sortIndex}return n}static _sortOpsDescending(e,t){const n=M.compareRangesUsingEnds(e.range,t.range);if(n===0){return t.sortIndex-e.sortIndex}return-n}}class eo{constructor(e,t,n,i,r,o,l,a,u){this._chunks=e;this._bom=t;this._cr=n;this._lf=i;this._crlf=r;this._containsRTL=o;this._containsUnusualLineTerminators=l;this._isBasicASCII=a;this._normalizeEOL=u}_getEOL(e){const t=this._cr+this._lf+this._crlf;const n=this._cr+this._crlf;if(t===0){return e===1?"\n":"\r\n"}if(n>t/2){return"\r\n"}return"\n"}create(e){const t=this._getEOL(e);const n=this._chunks;if(this._normalizeEOL&&(t==="\r\n"&&(this._cr>0||this._lf>0)||t==="\n"&&(this._cr>0||this._crlf>0))){for(let r=0,o=n.length;r<o;r++){const l=n[r].buffer.replace(/\r\n|\r|\n/g,t);const a=Ce(l);n[r]=new Te(l,a)}}const i=new He(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class to{constructor(){this.chunks=[];this.BOM="";this._hasPreviousChar=false;this._previousChar=0;this._tmpLineStarts=[];this.cr=0;this.lf=0;this.crlf=0;this.containsRTL=false;this.containsUnusualLineTerminators=false;this.isBasicASCII=true}acceptChunk(e){if(e.length===0){return}if(this.chunks.length===0){if(Hi(e)){this.BOM=Vi;e=e.substr(1)}}const t=e.charCodeAt(e.length-1);if(t===13||t>=55296&&t<=56319){this._acceptChunk1(e.substr(0,e.length-1),false);this._hasPreviousChar=true;this._previousChar=t}else{this._acceptChunk1(e,false);this._hasPreviousChar=false;this._previousChar=t}}_acceptChunk1(e,t){if(!t&&e.length===0){return}if(this._hasPreviousChar){this._acceptChunk2(String.fromCharCode(this._previousChar)+e)}else{this._acceptChunk2(e)}}_acceptChunk2(e){const t=Gr(this._tmpLineStarts,e);this.chunks.push(new Te(e,t.lineStarts));this.cr+=t.cr;this.lf+=t.lf;this.crlf+=t.crlf;if(!t.isBasicASCII){this.isBasicASCII=false;if(!this.containsRTL){this.containsRTL=ps(e)}if(!this.containsUnusualLineTerminators){this.containsUnusualLineTerminators=ms(e)}}}finish(e=true){this._finish();return new eo(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0){this._acceptChunk1("",true)}if(this._hasPreviousChar){this._hasPreviousChar=false;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=Ce(e.buffer);e.lineStarts=t;if(this._previousChar===13){this.cr++}}}}function Se(s){return s===47||s===92}function Is(s){return s.replace(/[\\/]/g,D.sep)}function no(s){if(s.indexOf("/")===-1){s=Is(s)}if(/^[a-zA-Z]:(\/|$)/.test(s)){s="/"+s}return s}function zn(s,e=D.sep){if(!s){return""}const t=s.length;const n=s.charCodeAt(0);if(Se(n)){if(Se(s.charCodeAt(1))){if(!Se(s.charCodeAt(2))){let r=3;const o=r;for(;r<t;r++){if(Se(s.charCodeAt(r))){break}}if(o!==r&&!Se(s.charCodeAt(r+1))){r+=1;for(;r<t;r++){if(Se(s.charCodeAt(r))){return s.slice(0,r+1).replace(/[\\/]/g,e)}}}}}return e}else if(so(n)){if(s.charCodeAt(1)===58){if(Se(s.charCodeAt(2))){return s.slice(0,2)+e}else{return s.slice(0,2)}}}let i=s.indexOf("://");if(i!==-1){i+=3;for(;i<t;i++){if(Se(s.charCodeAt(i))){return s.slice(0,i+1)}}}return""}function Wn(s,e,t,n=St){if(s===e){return true}if(!s||!e){return false}if(e.length>s.length){return false}if(t){const i=Fi(s,e);if(!i){return false}if(e.length===s.length){return true}let r=e.length;if(e.charAt(e.length-1)===n){r--}return s.charAt(r)===n}if(e.charAt(e.length-1)!==n){e+=n}return s.indexOf(e)===0}function so(s){return s>=65&&s<=90||s>=97&&s<=122}var q;(function(s){s.inMemory="inmemory";s.vscode="vscode";s.internal="private";s.walkThrough="walkThrough";s.walkThroughSnippet="walkThroughSnippet";s.http="http";s.https="https";s.file="file";s.mailto="mailto";s.untitled="untitled";s.data="data";s.command="command";s.vscodeRemote="vscode-remote";s.vscodeRemoteResource="vscode-remote-resource";s.vscodeManagedRemoteResource="vscode-managed-remote-resource";s.vscodeUserData="vscode-userdata";s.vscodeCustomEditor="vscode-custom-editor";s.vscodeNotebookCell="vscode-notebook-cell";s.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata";s.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff";s.vscodeNotebookCellOutput="vscode-notebook-cell-output";s.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff";s.vscodeNotebookMetadata="vscode-notebook-metadata";s.vscodeInteractiveInput="vscode-interactive-input";s.vscodeSettings="vscode-settings";s.vscodeWorkspaceTrust="vscode-workspace-trust";s.vscodeTerminal="vscode-terminal";s.vscodeChatCodeBlock="vscode-chat-code-block";s.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block";s.vscodeChatSesssion="vscode-chat-editor";s.webviewPanel="webview-panel";s.vscodeWebview="vscode-webview";s.extension="extension";s.vscodeFileResource="vscode-file";s.tmp="tmp";s.vsls="vsls";s.vscodeSourceControl="vscode-scm";s.commentsInput="comment";s.codeSetting="code-setting";s.outputChannel="output";s.accessibleView="accessible-view"})(q||(q={}));const io="tkn";class ro{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,t){this._serverRootPath=lo(e,t)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return D.join(this._serverRootPath,q.vscodeRemoteResource)}set(e,t,n){this._hosts[e]=t;this._ports[e]=n}setConnectionToken(e,t){this._connectionTokens[e]=t}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate){try{return this._delegate(e)}catch(l){bt(l);return e}}const t=e.authority;let n=this._hosts[t];if(n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1){n=`[${n}]`}const i=this._ports[t];const r=this._connectionTokens[t];let o=`path=${encodeURIComponent(e.path)}`;if(typeof r==="string"){o+=`&${io}=${encodeURIComponent(r)}`}return V.from({scheme:gn?this._preferredWebSchema:q.vscodeRemoteResource,authority:`${n}:${i}`,path:this._remoteResourcesPath,query:o})}}const oo=new ro;function lo(s,e){return D.join(e??"/",`${s.quality??"oss"}-${s.commit??"dev"}`)}const ao="vscode-app";class nt{constructor(){this.staticBrowserUris=new We;this.appResourcePathUrls=new Map}static{this.FALLBACK_AUTHORITY=ao}registerAppResourcePathUrl(e,t){this.appResourcePathUrls.set(e,t)}toUrl(e){let t=this.appResourcePathUrls.get(e);if(typeof t==="function"){t=t()}return new URL(t??e,globalThis.location?.href??import.meta.url).toString()}asBrowserUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToBrowserUri(t)}uriToBrowserUri(e){if(e.scheme===q.vscodeRemote){return oo.rewrite(e)}if(e.scheme===q.file&&(Ci||Li===`${q.vscodeFileResource}://${nt.FALLBACK_AUTHORITY}`)){return e.with({scheme:q.vscodeFileResource,authority:e.authority||nt.FALLBACK_AUTHORITY,query:null,fragment:null})}return this.staticBrowserUris.get(e)??e}asFileUri(e){const t=this.toUri(e,{toUrl:this.toUrl.bind(this)});return this.uriToFileUri(t)}uriToFileUri(e){if(e.scheme===q.vscodeFileResource){return e.with({scheme:q.file,authority:e.authority!==nt.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null})}return e}toUri(e,t){if(V.isUri(e)){return e}if(globalThis._VSCODE_FILE_ROOT){const n=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(n)){return V.joinPath(V.parse(n,true),e)}const i=Sr(n,e);return V.file(i)}return V.parse(t.toUrl(e))}registerStaticBrowserUri(e,t){this.staticBrowserUris.set(e,t);return an(()=>{if(this.staticBrowserUris.get(e)===t){this.staticBrowserUris.delete(e)}})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}}new nt;var Vn;(function(s){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function n(r){let o;if(typeof r==="string"){o=new URL(r).searchParams}else if(r instanceof URL){o=r.searchParams}else if(V.isUri(r)){o=new URL(r.toString(true)).searchParams}const l=o?.get(t);if(!l){return void 0}return e.get(l)}s.getHeadersFromQuery=n;function i(r,o,l){if(!globalThis.crossOriginIsolated){return}const a=o&&l?"3":l?"2":"1";if(r instanceof URLSearchParams){r.set(t,a)}else{r[t]=a}}s.addSearchParam=i})(Vn||(Vn={}));function pe(s){return Tt(s,true)}class uo{constructor(e){this._ignorePathCasing=e}compare(e,t,n=false){if(e===t){return 0}return Mi(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=false){if(e===t){return true}if(!e||!t){return false}return this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=false){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=false){if(e.scheme===t.scheme){if(e.scheme===q.file){return Wn(pe(e),pe(t),this._ignorePathCasing(e))&&e.query===t.query&&(n||e.fragment===t.fragment)}if(Hn(e.authority,t.authority)){return Wn(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}}return false}joinPath(e,...t){return V.joinPath(e,...t)}basenameOrAuthority(e){return ho(e)||e.authority}basename(e){return D.basename(e.path)}extname(e){return D.extname(e.path)}dirname(e){if(e.path.length===0){return e}let t;if(e.scheme===q.file){t=V.file(Nr(pe(e))).path}else{t=D.dirname(e.path);if(e.authority&&t.length&&t.charCodeAt(0)!==47){console.error(`dirname("${e.toString})) resulted in a relative path`);t="/"}}return e.with({path:t})}normalizePath(e){if(!e.path.length){return e}let t;if(e.scheme===q.file){t=V.file(Er(pe(e))).path}else{t=D.normalize(e.path)}return e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!Hn(e.authority,t.authority)){return void 0}if(e.scheme===q.file){const r=Ar(pe(e),pe(t));return Pe?Is(r):r}let n=e.path||"/";const i=t.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(n.length,i.length);r<o;r++){if(n.charCodeAt(r)!==i.charCodeAt(r)){if(n.charAt(r).toLowerCase()!==i.charAt(r).toLowerCase()){break}}}n=i.substr(0,r)+n.substr(r)}return D.relative(n,i)}resolvePath(e,t){if(e.scheme===q.file){const n=V.file(xr(pe(e),t));return e.with({authority:n.authority,path:n.path})}t=no(t);return e.with({path:D.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Ri(e,t)}hasTrailingPathSeparator(e,t=St){if(e.scheme===q.file){const n=pe(e);return n.length>zn(n).length&&n[n.length-1]===t}else{const n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=St){if(jn(e,t)){return e.with({path:e.path.substr(0,e.path.length-1)})}return e}addTrailingPathSeparator(e,t=St){let n=false;if(e.scheme===q.file){const i=pe(e);n=i!==void 0&&i.length===zn(i).length&&i[i.length-1]===t}else{t="/";const i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}if(!n&&!jn(e,t)){return e.with({path:e.path+"/"})}return e}}const P=new uo(()=>false);P.isEqual.bind(P);P.isEqualOrParent.bind(P);P.getComparisonKey.bind(P);P.basenameOrAuthority.bind(P);const ho=P.basename.bind(P);P.extname.bind(P);P.dirname.bind(P);P.joinPath.bind(P);P.normalizePath.bind(P);P.relativePath.bind(P);P.resolvePath.bind(P);P.isAbsolutePath.bind(P);const Hn=P.isEqualAuthority.bind(P);const jn=P.hasTrailingPathSeparator.bind(P);P.removeTrailingPathSeparator.bind(P);P.addTrailingPathSeparator.bind(P);var Gn;(function(s){s.META_DATA_LABEL="label";s.META_DATA_DESCRIPTION="description";s.META_DATA_SIZE="size";s.META_DATA_MIME="mime";function e(t){const n=new Map;const i=t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";"));i.split(";").forEach(o=>{const[l,a]=o.split(":");if(l&&a){n.set(l,a)}});const r=t.path.substring(0,t.path.indexOf(";"));if(r){n.set(s.META_DATA_MIME,r)}return n}s.parseMetaData=e})(Gn||(Gn={}));var Kn;(function(s){async function e(n){let i=void 0;const r=await Promise.all(n.map(o=>o.then(l=>l,l=>{if(!i){i=l}return void 0})));if(typeof i!=="undefined"){throw i}return r}s.settled=e;function t(n){return new Promise(async(i,r)=>{try{await n(i,r)}catch(o){r(o)}})}s.withAsyncBody=t})(Kn||(Kn={}));class re{static fromArray(e){return new re(t=>{t.emitMany(e)})}static fromPromise(e){return new re(async t=>{t.emitMany(await e)})}static fromPromisesResolveOrder(e){return new re(async t=>{await Promise.all(e.map(async n=>t.emitOne(await n)))})}static merge(e){return new re(async t=>{await Promise.all(e.map(async n=>{for await(const i of n){t.emitOne(i)}}))})}static{this.EMPTY=re.fromArray([])}constructor(e,t){this._state=0;this._results=[];this._error=null;this._onReturn=t;this._onStateChanged=new ue;queueMicrotask(async()=>{const n={emitOne:i=>this.emitOne(i),emitMany:i=>this.emitMany(i),reject:i=>this.reject(i)};try{await Promise.resolve(e(n));this.resolve()}catch(i){this.reject(i)}finally{n.emitOne=void 0;n.emitMany=void 0;n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2){throw this._error}if(e<this._results.length){return{done:false,value:this._results[e++]}}if(this._state===1){return{done:true,value:void 0}}await Nt.toPromise(this._onStateChanged.event)}while(true)},return:async()=>{this._onReturn?.();return{done:true,value:void 0}}}}static map(e,t){return new re(async n=>{for await(const i of e){n.emitOne(t(i))}})}map(e){return re.map(this,e)}static filter(e,t){return new re(async n=>{for await(const i of e){if(t(i)){n.emitOne(i)}}})}filter(e){return re.filter(this,e)}static coalesce(e){return re.filter(e,t=>!!t)}coalesce(){return re.coalesce(this)}static async toPromise(e){const t=[];for await(const n of e){t.push(n)}return t}toPromise(){return re.toPromise(this)}emitOne(e){if(this._state!==0){return}this._results.push(e);this._onStateChanged.fire()}emitMany(e){if(this._state!==0){return}this._results=this._results.concat(e);this._onStateChanged.fire()}resolve(){if(this._state!==0){return}this._state=1;this._onStateChanged.fire()}reject(e){if(this._state!==0){return}this._state=2;this._error=e;this._onStateChanged.fire()}}new rs(1e4);const Ge=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"});function Kt(...s){switch(s.length){case 1:return ie(1667,"Did you mean {0}?",s[0]);case 2:return ie(1668,"Did you mean {0} or {1}?",s[0],s[1]);case 3:return ie(1669,"Did you mean {0}, {1} or {2}?",s[0],s[1],s[2]);default:return void 0}}const co=ie(1670,"Did you forget to open or close the quote?");const fo=ie(1671,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class Ne{constructor(){this._input="";this._start=0;this._current=0;this._tokens=[];this._errors=[];this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw Vs(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([["not",14],["in",13],["false",12],["true",11]])}get errors(){return this._errors}reset(e){this._input=e;this._start=0;this._current=0;this._tokens=[];this._errors=[];return this}scan(){while(!this._isAtEnd()){this._start=this._current;const e=this._advance();switch(e){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else{this._addToken(2)}break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else if(this._match(126)){this._addToken(9)}else{this._error(Kt("==","=~"))}break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:if(this._match(38)){this._addToken(15)}else{this._error(Kt("&&"))}break;case 124:if(this._match(124)){this._addToken(16)}else{this._error(Kt("||"))}break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}}this._start=this._current;this._addToken(20);return Array.from(this._tokens)}_match(e){if(this._isAtEnd()){return false}if(this._input.charCodeAt(this._current)!==e){return false}this._current++;return true}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start;const n=this._input.substring(this._start,this._current);const i={type:19,offset:this._start,lexeme:n};this._errors.push({offset:t,lexeme:n,additionalInfo:e});this._tokens.push(i)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current);const n=Ne._keywords.get(t);if(n){this._addToken(n)}else{this._tokens.push({type:17,lexeme:t,offset:this._start})}}}_quotedString(){while(this._peek()!==39&&!this._isAtEnd()){this._advance()}if(this._isAtEnd()){this._error(co);return}this._advance();this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current;let t=false;let n=false;while(true){if(e>=this._input.length){this._current=e;this._error(fo);return}const r=this._input.charCodeAt(e);if(t){t=false}else if(r===47&&!n){e++;break}else if(r===91){n=true}else if(r===92){t=true}else if(r===93){n=false}e++}while(e<this._input.length&&Ne._regexFlags.has(this._input.charCodeAt(e))){e++}this._current=e;const i=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:i,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}const j=new Map;j.set("false",false);j.set("true",true);j.set("isMac",dn);j.set("isLinux",_i);j.set("isWindows",Pe);j.set("isWeb",gn);j.set("isMacNative",dn&&!gn);j.set("isEdge",Ei);j.set("isFirefox",yi);j.set("isChrome",hs);j.set("isSafari",vi);const go=Object.prototype.hasOwnProperty;const po={regexParsingWithErrorRecovery:true};const mo=ie(476,"Empty context key expression");const _o=ie(477,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively.");const Co=ie(478,"'in' after 'not'.");const Qn=ie(479,"closing parenthesis ')'");const bo=ie(480,"Unexpected token");const Lo=ie(481,"Did you forget to put && or || before the token?");const wo=ie(482,"Unexpected end of expression");const yo=ie(483,"Did you forget to put a context key?");class je{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=po){this._config=e;this._scanner=new Ne;this._tokens=[];this._current=0;this._parsingErrors=[];this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:mo,offset:0,lexeme:"",additionalInfo:_o});return void 0}this._tokens=this._scanner.reset(e).scan();this._current=0;this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const n=this._peek();const i=n.type===17?Lo:void 0;this._parsingErrors.push({message:bo,offset:n.offset,lexeme:Ne.getLexeme(n),additionalInfo:i});throw je._parseError}return t}catch(t){if(!(t===je._parseError)){throw t}return void 0}}_expr(){return this._or()}_or(){const e=[this._and()];while(this._matchOne(16)){const t=this._and();e.push(t)}return e.length===1?e[0]:J.or(...e)}_and(){const e=[this._term()];while(this._matchOne(15)){const t=this._term();e.push(t)}return e.length===1?e[0]:J.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:this._advance();return Q.INSTANCE;case 12:this._advance();return X.INSTANCE;case 0:{this._advance();const t=this._expr();this._consume(1,Qn);return t?.negate()}case 17:this._advance();return Fe.create(e.lexeme);default:throw this._errExpectedButGot(`KEY | true | false | '(' expression ')'`,e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:this._advance();return J.true();case 12:this._advance();return J.false();case 0:{this._advance();const t=this._expr();this._consume(1,Qn);return t}case 17:{const t=e.lexeme;this._advance();if(this._matchOne(9)){const i=this._peek();if(!this._config.regexParsingWithErrorRecovery){this._advance();if(i.type!==10){throw this._errExpectedButGot(`REGEX`,i)}const r=i.lexeme;const o=r.lastIndexOf("/");const l=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let a;try{a=new RegExp(r.substring(1,o),l)}catch(u){throw this._errExpectedButGot(`REGEX`,i)}return it.create(t,a)}switch(i.type){case 10:case 19:{const r=[i.lexeme];this._advance();let o=this._peek();let l=0;for(let f=0;f<i.lexeme.length;f++){if(i.lexeme.charCodeAt(f)===40){l++}else if(i.lexeme.charCodeAt(f)===41){l--}}while(!this._isAtEnd()&&o.type!==15&&o.type!==16){switch(o.type){case 0:l++;break;case 1:l--;break;case 10:case 18:for(let f=0;f<o.lexeme.length;f++){if(o.lexeme.charCodeAt(f)===40){l++}else if(i.lexeme.charCodeAt(f)===41){l--}}}if(l<0){break}r.push(Ne.getLexeme(o));this._advance();o=this._peek()}const a=r.join("");const u=a.lastIndexOf("/");const c=u===a.length-1?void 0:this._removeFlagsGY(a.substring(u+1));let h;try{h=new RegExp(a.substring(1,u),c)}catch(f){throw this._errExpectedButGot(`REGEX`,i)}return J.regex(t,h)}case 18:{const r=i.lexeme;this._advance();let o=null;if(!Ni(r)){const l=r.indexOf("/");const a=r.lastIndexOf("/");if(l!==a&&l>=0){const u=r.slice(l+1,a);const c=r[a+1]==="i"?"i":"";try{o=new RegExp(u,c)}catch(h){throw this._errExpectedButGot(`REGEX`,i)}}}if(o===null){throw this._errExpectedButGot("REGEX",i)}return it.create(t,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Co);const i=this._value();return J.notIn(t,i)}const n=this._peek().type;switch(n){case 3:{this._advance();const i=this._value();if(this._previous().type===18){return J.equals(t,i)}switch(i){case"true":return J.has(t);case"false":return J.not(t);default:return J.equals(t,i)}}case 4:{this._advance();const i=this._value();if(this._previous().type===18){return J.notEquals(t,i)}switch(i){case"true":return J.not(t);case"false":return J.has(t);default:return J.notEquals(t,i)}}case 5:this._advance();return ht.create(t,this._value());case 6:this._advance();return ct.create(t,this._value());case 7:this._advance();return at.create(t,this._value());case 8:this._advance();return ut.create(t,this._value());case 13:this._advance();return J.in(t,this._value());default:return J.has(t)}}case 20:this._parsingErrors.push({message:wo,offset:e.offset,lexeme:"",additionalInfo:yo});throw je._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:this._advance();return e.lexeme;case 11:this._advance();return"true";case 12:this._advance();return"false";case 13:this._advance();return"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){if(this._check(e)){this._advance();return true}return false}_advance(){if(!this._isAtEnd()){this._current++}return this._previous()}_consume(e,t){if(this._check(e)){return this._advance()}throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,n){const i=ie(484,"Expected: {0}\nReceived: '{1}'.",e,Ne.getLexeme(t));const r=t.offset;const o=Ne.getLexeme(t);this._parsingErrors.push({message:i,offset:r,lexeme:o,additionalInfo:n});return je._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}}class J{static false(){return Q.INSTANCE}static true(){return X.INSTANCE}static has(e){return Re.create(e)}static equals(e,t){return ot.create(e,t)}static notEquals(e,t){return lt.create(e,t)}static regex(e,t){return it.create(e,t)}static in(e,t){return Rt.create(e,t)}static notIn(e,t){return Ft.create(e,t)}static not(e){return Fe.create(e)}static and(...e){return Ie.create(e,null,true)}static or(...e){return fe.create(e,null,true)}static greater(e,t){return at.create(e,t)}static greaterEquals(e,t){return ut.create(e,t)}static smaller(e,t){return ht.create(e,t)}static smallerEquals(e,t){return ct.create(e,t)}static{this._parser=new je({regexParsingWithErrorRecovery:false})}static deserialize(e){if(e===void 0||e===null){return void 0}const t=this._parser.parse(e);return t}}function st(s,e){return s.cmp(e)}class Q{static{this.INSTANCE=new Q}constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return false}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return X.INSTANCE}}class X{static{this.INSTANCE=new X}constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return true}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Q.INSTANCE}}class Re{static create(e,t=null){const n=j.get(e);if(typeof n==="boolean"){return n?X.INSTANCE:Q.INSTANCE}return new Re(e,t)}constructor(e,t){this.key=e;this.negated=t;this.type=2}cmp(e){if(e.type!==this.type){return this.type-e.type}return Os(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=j.get(this.key);if(typeof e==="boolean"){return e?X.INSTANCE:Q.INSTANCE}return this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){if(!this.negated){this.negated=Fe.create(this.key,this)}return this.negated}}class ot{static create(e,t,n=null){if(typeof t==="boolean"){return t?Re.create(e,n):Fe.create(e,n)}const i=j.get(e);if(typeof i==="boolean"){const r=i?"true":"false";return t===r?X.INSTANCE:Q.INSTANCE}return new ot(e,t,n)}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=4}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=j.get(this.key);if(typeof e==="boolean"){const t=e?"true":"false";return this.value===t?X.INSTANCE:Q.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=lt.create(this.key,this.value,this)}return this.negated}}class Rt{static create(e,t){return new Rt(e,t)}constructor(e,t){this.key=e;this.valueKey=t;this.type=10;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.valueKey,e.key,e.valueKey)}equals(e){if(e.type===this.type){return this.key===e.key&&this.valueKey===e.valueKey}return false}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey);const n=e.getValue(this.key);if(Array.isArray(t)){return t.includes(n)}if(typeof n==="string"&&typeof t==="object"&&t!==null){return go.call(t,n)}return false}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){if(!this.negated){this.negated=Ft.create(this.key,this.valueKey)}return this.negated}}class Ft{static create(e,t){return new Ft(e,t)}constructor(e,t){this.key=e;this.valueKey=t;this.type=11;this._negated=Rt.create(e,t)}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._negated.cmp(e._negated)}equals(e){if(e.type===this.type){return this._negated.equals(e._negated)}return false}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class lt{static create(e,t,n=null){if(typeof t==="boolean"){if(t){return Fe.create(e,n)}return Re.create(e,n)}const i=j.get(e);if(typeof i==="boolean"){const r=i?"true":"false";return t===r?Q.INSTANCE:X.INSTANCE}return new lt(e,t,n)}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=5}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=j.get(this.key);if(typeof e==="boolean"){const t=e?"true":"false";return this.value===t?Q.INSTANCE:X.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=ot.create(this.key,this.value,this)}return this.negated}}class Fe{static create(e,t=null){const n=j.get(e);if(typeof n==="boolean"){return n?Q.INSTANCE:X.INSTANCE}return new Fe(e,t)}constructor(e,t){this.key=e;this.negated=t;this.type=3}cmp(e){if(e.type!==this.type){return this.type-e.type}return Os(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=j.get(this.key);if(typeof e==="boolean"){return e?Q.INSTANCE:X.INSTANCE}return this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){if(!this.negated){this.negated=Re.create(this.key,this)}return this.negated}}function Dt(s,e){if(typeof s==="string"){const t=parseFloat(s);if(!isNaN(t)){s=t}}if(typeof s==="string"||typeof s==="number"){return e(s)}return Q.INSTANCE}class at{static create(e,t,n=null){return Dt(t,i=>new at(e,i,n))}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=12}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){if(!this.negated){this.negated=ct.create(this.key,this.value,this)}return this.negated}}class ut{static create(e,t,n=null){return Dt(t,i=>new ut(e,i,n))}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=13}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=ht.create(this.key,this.value,this)}return this.negated}}class ht{static create(e,t,n=null){return Dt(t,i=>new ht(e,i,n))}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=14}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){if(!this.negated){this.negated=ut.create(this.key,this.value,this)}return this.negated}}class ct{static create(e,t,n=null){return Dt(t,i=>new ct(e,i,n))}constructor(e,t,n){this.key=e;this.value=t;this.negated=n;this.type=15}cmp(e){if(e.type!==this.type){return this.type-e.type}return De(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=at.create(this.key,this.value,this)}return this.negated}}class it{static create(e,t){return new it(e,t)}constructor(e,t){this.key=e;this.regexp=t;this.type=7;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.key<e.key){return-1}if(this.key>e.key){return 1}const t=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";if(t<n){return-1}if(t>n){return 1}return 0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";return this.key===e.key&&t===n}return false}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):false}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){if(!this.negated){this.negated=Mt.create(this)}return this.negated}}class Mt{static create(e){return new Mt(e)}constructor(e){this._actual=e;this.type=8}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._actual.cmp(e._actual)}equals(e){if(e.type===this.type){return this._actual.equals(e._actual)}return false}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new Mt(this._actual.map(e))}negate(){return this._actual}}function ks(s){let e=null;for(let t=0,n=s.length;t<n;t++){const i=s[t].substituteConstants();if(s[t]!==i){if(e===null){e=[];for(let r=0;r<t;r++){e[r]=s[r]}}}if(e!==null){e[t]=i}}if(e===null){return s}return e}class Ie{static create(e,t,n){return Ie._normalizeArr(e,t,n)}constructor(e,t){this.expr=e;this.negated=t;this.type=6}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let t=0,n=this.expr.length;t<n;t++){const i=st(this.expr[t],e.expr[t]);if(i!==0){return i}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let t=0,n=this.expr.length;t<n;t++){if(!this.expr[t].equals(e.expr[t])){return false}}return true}return false}substituteConstants(){const e=ks(this.expr);if(e===this.expr){return this}return Ie.create(e,this.negated,false)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++){if(!this.expr[t].evaluate(e)){return false}}return true}static _normalizeArr(e,t,n){const i=[];let r=false;for(const o of e){if(!o){continue}if(o.type===1){r=true;continue}if(o.type===0){return Q.INSTANCE}if(o.type===6){i.push(...o.expr);continue}i.push(o)}if(i.length===0&&r){return X.INSTANCE}if(i.length===0){return void 0}if(i.length===1){return i[0]}i.sort(st);for(let o=1;o<i.length;o++){if(i[o-1].equals(i[o])){i.splice(o,1);o--}}if(i.length===1){return i[0]}while(i.length>1){const o=i[i.length-1];if(o.type!==9){break}i.pop();const l=i.pop();const a=i.length===0;const u=fe.create(o.expr.map(c=>Ie.create([c,l],null,n)),null,a);if(u){i.push(u);i.sort(st)}}if(i.length===1){return i[0]}if(n){for(let o=0;o<i.length;o++){for(let l=o+1;l<i.length;l++){if(i[o].negate().equals(i[l])){return Q.INSTANCE}}}if(i.length===1){return i[0]}}return new Ie(i,t)}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr){e.push(...t.keys())}return e}map(e){return new Ie(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr){e.push(t.negate())}this.negated=fe.create(e,this,true)}return this.negated}}class fe{static create(e,t,n){return fe._normalizeArr(e,t,n)}constructor(e,t){this.expr=e;this.negated=t;this.type=9}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let t=0,n=this.expr.length;t<n;t++){const i=st(this.expr[t],e.expr[t]);if(i!==0){return i}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let t=0,n=this.expr.length;t<n;t++){if(!this.expr[t].equals(e.expr[t])){return false}}return true}return false}substituteConstants(){const e=ks(this.expr);if(e===this.expr){return this}return fe.create(e,this.negated,false)}evaluate(e){for(let t=0,n=this.expr.length;t<n;t++){if(this.expr[t].evaluate(e)){return true}}return false}static _normalizeArr(e,t,n){let i=[];let r=false;if(e){for(let o=0,l=e.length;o<l;o++){const a=e[o];if(!a){continue}if(a.type===0){r=true;continue}if(a.type===1){return X.INSTANCE}if(a.type===9){i=i.concat(a.expr);continue}i.push(a)}if(i.length===0&&r){return Q.INSTANCE}i.sort(st)}if(i.length===0){return void 0}if(i.length===1){return i[0]}for(let o=1;o<i.length;o++){if(i[o-1].equals(i[o])){i.splice(o,1);o--}}if(i.length===1){return i[0]}if(n){for(let o=0;o<i.length;o++){for(let l=o+1;l<i.length;l++){if(i[o].negate().equals(i[l])){return X.INSTANCE}}}if(i.length===1){return i[0]}}return new fe(i,t)}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr){e.push(...t.keys())}return e}map(e){return new fe(this.expr.map(t=>t.map(e)),null)}negate(){if(!this.negated){const e=[];for(const t of this.expr){e.push(t.negate())}while(e.length>1){const t=e.shift();const n=e.shift();const i=[];for(const r of Yn(t)){for(const o of Yn(n)){i.push(Ie.create([r,o],null,false))}}e.unshift(fe.create(i,null,false))}this.negated=fe.create(e,this,true)}return this.negated}}class Ke extends Re{static{this._info=[]}static all(){return Ke._info.values()}constructor(e,t,n){super(e,null);this._defaultValue=t;if(typeof n==="object"){Ke._info.push({...n,key:e})}else if(n!==true){Ke._info.push({key:e,description:n,type:t!==null&&t!==void 0?typeof t:void 0})}}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return ot.create(this.key,e)}notEqualsTo(e){return lt.create(this.key,e)}}function Os(s,e){if(s<e){return-1}if(s>e){return 1}return 0}function De(s,e,t,n){if(s<t){return-1}if(s>t){return 1}if(e<n){return-1}if(e>n){return 1}return 0}function Yn(s){if(s.type===9){return s.expr}return[s]}var Le;(function(s){s.serviceIds=new Map;s.DI_TARGET="$di$target";s.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[s.DI_DEPENDENCIES]||[]}s.getServiceDependencies=e})(Le||(Le={}));Eo("instantiationService");function vo(s,e,t){if(e[Le.DI_TARGET]===e){e[Le.DI_DEPENDENCIES].push({id:s,index:t})}else{e[Le.DI_DEPENDENCIES]=[{id:s,index:t}];e[Le.DI_TARGET]=e}}function Eo(s){if(Le.serviceIds.has(s)){return Le.serviceIds.get(s)}const e=function(t,n,i){if(arguments.length!==3){throw new Error("@IServiceName-decorator can only be used to decorate a parameter")}vo(e,t,i)};e.toString=()=>s;Le.serviceIds.set(s,e);return e}const on=["W","X","Y","Z","a","b","c","d","e","f"];const So=new RegExp(`^[${on.join("")}]+`);const Ts=7;function xo(s){if(s.scheme!==q.vscodeNotebookCell){return void 0}const e=s.fragment.indexOf("s");if(e<0){return void 0}const t=parseInt(s.fragment.substring(0,e).replace(So,""),Ts);const n=bs(s.fragment.substring(e+1)).toString();if(isNaN(t)){return void 0}return{handle:t,notebook:s.with({scheme:n,fragment:null})}}function Ao(s,e){const t=e.toString(Ts);const n=t.length<on.length?on[t.length-1]:"z";const i=`${n}${t}s${Ls(te.fromString(s.scheme),true,true)}`;return s.with({scheme:q.vscodeNotebookCell,fragment:i})}function No(s){if(s.scheme!==q.vscodeNotebookMetadata){return void 0}const e=bs(s.fragment).toString();return s.with({scheme:e,fragment:null})}function Io(s){const e=`${Ls(te.fromString(s.scheme),true,true)}`;return s.with({scheme:q.vscodeNotebookMetadata,fragment:e})}var ln;(function(s){s[s["Markup"]=1]="Markup";s[s["Code"]=2]="Code"})(ln||(ln={}));["application/json","application/javascript","text/html","image/svg+xml",Ge.latex,Ge.markdown,"image/png","image/jpeg",Ge.text];[Ge.latex,Ge.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",Ge.text];var Jn;(function(s){s[s["Unconfirmed"]=1]="Unconfirmed";s[s["Pending"]=2]="Pending";s[s["Executing"]=3]="Executing"})(Jn||(Jn={}));var Zn;(function(s){s[s["Unconfirmed"]=1]="Unconfirmed";s[s["Pending"]=2]="Pending";s[s["Executing"]=3]="Executing"})(Zn||(Zn={}));var be;(function(s){s[s["ModelChange"]=1]="ModelChange";s[s["Move"]=2]="Move";s[s["ChangeCellLanguage"]=5]="ChangeCellLanguage";s[s["Initialize"]=6]="Initialize";s[s["ChangeCellMetadata"]=7]="ChangeCellMetadata";s[s["Output"]=8]="Output";s[s["OutputItem"]=9]="OutputItem";s[s["ChangeCellContent"]=10]="ChangeCellContent";s[s["ChangeDocumentMetadata"]=11]="ChangeDocumentMetadata";s[s["ChangeCellInternalMetadata"]=12]="ChangeCellInternalMetadata";s[s["ChangeCellMime"]=13]="ChangeCellMime";s[s["Unknown"]=100]="Unknown"})(be||(be={}));var Xn;(function(s){s[s["Handle"]=0]="Handle";s[s["Index"]=1]="Index"})(Xn||(Xn={}));var es;(function(s){s.scheme=q.vscodeNotebookMetadata;function e(n){return Io(n)}s.generate=e;function t(n){return No(n)}s.parse=t})(es||(es={}));var ts;(function(s){s.scheme=q.vscodeNotebookCell;function e(l,a){return Ao(l,a)}s.generate=e;function t(l){return xo(l)}s.parse=t;function n(l,a){return l.with({scheme:q.vscodeNotebookCellOutput,fragment:`op${a??""},${l.scheme!==q.file?l.scheme:""}`})}s.generateCellOutputUri=n;function i(l){if(l.scheme!==q.vscodeNotebookCellOutput){return}const a=/^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\,(.*)$/i.exec(l.fragment);if(!a){return void 0}const u=a[1]&&a[1]!==""?a[1]:void 0;const c=a[2];return{outputId:u,notebook:l.with({scheme:c||q.file,fragment:null})}}s.parseCellOutputUri=i;function r(l,a,u){return s.generate(l,a).with({scheme:u})}s.generateCellPropertyUri=r;function o(l,a){if(l.scheme!==a){return void 0}return s.parse(l.with({scheme:s.scheme}))}s.parseCellPropertyUri=o})(ts||(ts={}));new Ke("notebookEditorCursorAtBoundary","none");new Ke("notebookEditorCursorAtLineBoundary","none");var ns;(function(s){s["default"]="default";s["option"]="option"})(ns||(ns={}));var ss;(function(s){s["Cells"]="cells";s["Text"]="text";s["None"]="none"})(ss||(ss={}));new TextDecoder;const ko=`${String.fromCharCode(27)}[A`;ko.split("").map(s=>s.charCodeAt(0));const Oo="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function To(s=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of Oo){if(s.indexOf(t)>=0){continue}e+="\\"+t}e+="\\s]+)";return new RegExp(e,"g")}const Mo=To();function Ms(s){let e=Mo;if(s&&s instanceof RegExp){if(!s.global){let t="g";if(s.ignoreCase){t+="i"}if(s.multiline){t+="m"}if(s.unicode){t+="u"}e=new RegExp(s.source,t)}else{e=s}}e.lastIndex=0;return e}const Ps=new ii;Ps.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function Rs(s,e,t,n,i){e=Ms(e);if(!i){i=xt.first(Ps)}if(t.length>i.maxLen){let u=s-i.maxLen/2;if(u<0){u=0}else{n+=u}t=t.substring(u,s+i.maxLen/2);return Rs(s,e,t,n,i)}const r=Date.now();const o=s-1-n;let l=-1;let a=null;for(let u=1;;u++){if(Date.now()-r>=i.timeBudget){break}const c=o-i.windowSize*u;e.lastIndex=Math.max(0,c);const h=Po(e,t,o,l);if(!h&&a){break}a=h;if(c<=0){break}l=c}if(a){const u={word:a[0],startColumn:n+1+a.index,endColumn:n+1+a.index+a[0].length};e.lastIndex=0;return u}return null}function Po(s,e,t,n){let i;while(i=s.exec(e)){const r=i.index||0;if(r<=t&&s.lastIndex>=t){return i}else if(n>0&&r>n){return null}}return null}class Ro{constructor(e){this.values=e;this.prefixSum=new Uint32Array(e.length);this.prefixSumValidIndex=new Int32Array(1);this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,t){e=ze(e);const n=this.values;const i=this.prefixSum;const r=t.length;if(r===0){return false}this.values=new Uint32Array(n.length+r);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e),e+r);this.values.set(t,e);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}this.prefixSum=new Uint32Array(this.values.length);if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1))}return true}setValue(e,t){e=ze(e);t=ze(t);if(this.values[e]===t){return false}this.values[e]=t;if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}return true}removeValues(e,t){e=ze(e);t=ze(t);const n=this.values;const i=this.prefixSum;if(e>=n.length){return false}const r=n.length-e;if(t>=r){t=r}if(t===0){return false}this.values=new Uint32Array(n.length-t);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e+t),e);this.prefixSum=new Uint32Array(this.values.length);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(i.subarray(0,this.prefixSumValidIndex[0]+1))}return true}getTotalSum(){if(this.values.length===0){return 0}return this._getPrefixSum(this.values.length-1)}getPrefixSum(e){if(e<0){return 0}e=ze(e);return this._getPrefixSum(e)}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0]){return this.prefixSum[e]}let t=this.prefixSumValidIndex[0]+1;if(t===0){this.prefixSum[0]=this.values[0];t++}if(e>=this.values.length){e=this.values.length-1}for(let n=t;n<=e;n++){this.prefixSum[n]=this.prefixSum[n-1]+this.values[n]}this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e);return this.prefixSum[e]}getIndexOf(e){e=Math.floor(e);this.getTotalSum();let t=0;let n=this.values.length-1;let i=0;let r=0;let o=0;while(t<=n){i=t+(n-t)/2|0;r=this.prefixSum[i];o=r-this.values[i];if(e<o){n=i-1}else if(e>=r){t=i+1}else{break}}return new Fo(i,e-o)}}class Fo{constructor(e,t){this.index=e;this.remainder=t;this._prefixSumIndexOfResultBrand=void 0;this.index=e;this.remainder=t}}class Do{constructor(e,t,n,i){this._uri=e;this._lines=t;this._eol=n;this._versionId=i;this._lineStarts=null;this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){if(this._cachedTextValue===null){this._cachedTextValue=this._lines.join(this._eol)}return this._cachedTextValue}onEvents(e){if(e.eol&&e.eol!==this._eol){this._eol=e.eol;this._lineStarts=null}const t=e.changes;for(const n of t){this._acceptDeleteRange(n.range);this._acceptInsertText(new Z(n.range.startLineNumber,n.range.startColumn),n.text)}this._versionId=e.versionId;this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length;const t=this._lines.length;const n=new Uint32Array(t);for(let i=0;i<t;i++){n[i]=this._lines[i].length+e}this._lineStarts=new Ro(n)}}_setLineText(e,t){this._lines[e]=t;if(this._lineStarts){this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn){return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1));this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber);if(this._lineStarts){this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}}_acceptInsertText(e,t){if(t.length===0){return}const n=Oi(t);if(n.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1);this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);const i=new Uint32Array(n.length-1);for(let r=1;r<n.length;r++){this._lines.splice(e.lineNumber+r-1,0,n[r]);i[r-1]=n[r].length+this._eol.length}if(this._lineStarts){this._lineStarts.insertValues(e.lineNumber,i)}}}class Bo extends Do{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let n=0;n<this._lines.length;n++){const i=this._lines[n];const r=this.offsetAt(new Z(n+1,1));const o=i.matchAll(e);for(const l of o){if(l.index||l.index===0){l.index=l.index+r}t.push(l)}}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const n=Rs(e.column,Ms(t),this._lines[e.lineNumber-1],0);if(n){return new M(e.lineNumber,n.startColumn,e.lineNumber,n.endColumn)}return null}getWordUntilPosition(e,t){const n=this.getWordAtPosition(e,t);if(!n){return{word:"",startColumn:e.column,endColumn:e.column}}return{word:this._lines[e.lineNumber-1].substring(n.startColumn-1,e.column-1),startColumn:n.startColumn,endColumn:e.column}}words(e){const t=this._lines;const n=this._wordenize.bind(this);let i=0;let r="";let o=0;let l=[];return{*[Symbol.iterator](){while(true){if(o<l.length){const a=r.substring(l[o].start,l[o].end);o+=1;yield a}else{if(i<t.length){r=t[i];l=n(r,e);o=0;i+=1}else{break}}}}}}getLineWords(e,t){const n=this._lines[e-1];const i=this._wordenize(n,t);const r=[];for(const o of i){r.push({word:n.substring(o.start,o.end),startColumn:o.start+1,endColumn:o.end+1})}return r}_wordenize(e,t){const n=[];let i;t.lastIndex=0;while(i=t.exec(e)){if(i[0].length===0){break}n.push({start:i.index,end:i.index+i[0].length})}return n}getValueInRange(e){e=this._validateRange(e);if(e.startLineNumber===e.endLineNumber){return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1)}const t=this._eol;const n=e.startLineNumber-1;const i=e.endLineNumber-1;const r=[];r.push(this._lines[n].substring(e.startColumn-1));for(let o=n+1;o<i;o++){r.push(this._lines[o])}r.push(this._lines[i].substring(0,e.endColumn-1));return r.join(t)}offsetAt(e){e=this._validatePosition(e);this._ensureLineStarts();return this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e);e=Math.max(0,e);this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e);const n=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,n)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn});const n=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});if(t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||n.lineNumber!==e.endLineNumber||n.column!==e.endColumn){return{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:n.lineNumber,endColumn:n.column}}return e}_validatePosition(e){if(!Z.isIPosition(e)){throw new Error("bad position")}let{lineNumber:t,column:n}=e;let i=false;if(t<1){t=1;n=1;i=true}else if(t>this._lines.length){t=this._lines.length;n=this._lines[t-1].length+1;i=true}else{const r=this._lines[t-1].length+1;if(n<1){n=1;i=true}else if(n>r){n=r;i=true}}if(!i){return e}else{return{lineNumber:t,column:n}}}}class Fs{get eol(){return this._eol==="\r\n"?2:1}constructor(e,t,n,i,r,o,l,a,u,c){this.handle=e;this._eol=i;this.language=o;this.cellKind=l;this.outputs=a;this.metadata=u;this.internalMetadata=c;this.textModel=new Bo(t,n,i,r)}onEvents(e){this.textModel.onEvents(e);this._hash=void 0}getValue(){return this.textModel.getValue()}async getComparisonValue(){return this._hash??=this._getHash()}async _getHash(){let e=ce(104579,0);e=Ae(this.language,e);e=Ae(this.getValue(),e);e=Ae(this.metadata,e);e=Ae(this.internalMetadata,e);for(const n of this.outputs){e=Ae(n.metadata,e);for(const i of n.outputs){e=Ae(i.mime,e)}}const t=await Promise.all(this.outputs.flatMap(n=>n.outputs.map(i=>crypto.subtle.digest("sha-1",i.data.buffer))));for(const n of t){e=ce(new Int32Array(n)[0],e)}return e}}class Uo{constructor(e,t,n,i){this.uri=e;this.cells=t;this.metadata=n;this.transientDocumentMetadata=i}acceptModelChanged(e){e.rawEvents.forEach(t=>{if(t.kind===be.ModelChange){this._spliceNotebookCells(t.changes)}else if(t.kind===be.Move){const n=this.cells.splice(t.index,1);this.cells.splice(t.newIdx,0,...n)}else if(t.kind===be.Output){const n=this.cells[t.index];n.outputs=t.outputs}else if(t.kind===be.ChangeCellLanguage){this._assertIndex(t.index);const n=this.cells[t.index];n.language=t.language}else if(t.kind===be.ChangeCellMetadata){this._assertIndex(t.index);const n=this.cells[t.index];n.metadata=t.metadata}else if(t.kind===be.ChangeCellInternalMetadata){this._assertIndex(t.index);const n=this.cells[t.index];n.internalMetadata=t.internalMetadata}else if(t.kind===be.ChangeDocumentMetadata){this.metadata=t.metadata}})}_assertIndex(e){if(e<0||e>=this.cells.length){throw new Error(`Illegal index ${e}. Cells length: ${this.cells.length}`)}}_spliceNotebookCells(e){e.reverse().forEach(t=>{const n=t[2];const i=n.map(r=>{return new Fs(r.handle,V.parse(r.url),r.source,r.eol,r.versionId,r.language,r.cellKind,r.outputs,r.metadata)});this.cells.splice(t[0],t[1],...i)})}}class Pt{static async create(e){const t=new Int32Array(e.cells.length);await Promise.all(e.cells.map(async(n,i)=>{t[i]=await n.getComparisonValue()}));return new Pt(t)}constructor(e){this.hashValue=e}getElements(){return this.hashValue}}class $o{constructor(){this._models=Object.create(null)}dispose(){}$acceptNewModel(e,t,n,i){this._models[e]=new Uo(V.parse(e),i.map(r=>new Fs(r.handle,V.parse(r.url),r.source,r.eol,r.versionId,r.language,r.cellKind,r.outputs,r.metadata)),t,n)}$acceptModelChanged(e,t){const n=this._models[e];n?.acceptModelChanged(t)}$acceptCellModelChanged(e,t,n){const i=this._models[e];i.cells.find(r=>r.handle===t)?.onEvents(n)}$acceptRemovedModel(e){if(!this._models[e]){return}delete this._models[e]}async $computeDiff(e,t){const n=this._getModel(e);const i=this._getModel(t);const[r,o]=await Promise.all([Pt.create(n),Pt.create(i)]);const l=new Oe(r,o);const a=l.ComputeDiff(false);const u=Pn(n.metadata,h=>!n.transientDocumentMetadata[h]);const c=Pn(i.metadata,h=>!i.transientDocumentMetadata[h]);return{metadataChanged:JSON.stringify(u)!==JSON.stringify(c),cellsDiff:a}}$canPromptRecommendation(e){const t=this._getModel(e);const n=t.cells;for(let i=0;i<n.length;i++){const r=n[i];if(r.cellKind===ln.Markup){continue}if(r.language!=="python"){continue}const o=new qr("import\\s*pandas|from\\s*pandas",true,false,null);const l=o.parseSearchRequest();if(!l){continue}const a=new to;a.acceptChunk(r.getValue());const u=a.finish(true);const c=u.create(r.eol).textBuffer;const h=c.getLineCount();const f=Math.min(h,20);const d=new M(1,1,f,c.getLineLength(f)+1);const w=c.findMatchesLineByLine(d,l,true,1);if(w.length>0){return true}}return false}_getModel(e){return this._models[e]}}function qo(s){return new $o}er(qo);
